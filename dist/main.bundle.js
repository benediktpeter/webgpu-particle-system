(()=>{"use strict";var t={579:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s});var n=r(15),i=r.n(n),a=r(645),o=r.n(a)()(i());o.push([t.id,"h1 {\r\n    font-family: sans-serif;\r\n}\r\n\r\n.fpsCounter {\r\n    font-family: sans-serif;\r\n}\r\n","",{version:3,sources:["webpack://./dist/site.css"],names:[],mappings:"AAAA;IACI,uBAAuB;AAC3B;;AAEA;IACI,uBAAuB;AAC3B",sourcesContent:["h1 {\r\n    font-family: sans-serif;\r\n}\r\n\r\n.fpsCounter {\r\n    font-family: sans-serif;\r\n}\r\n"],sourceRoot:""}]);const s=o},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=t(e);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(n)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);n&&i[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),e.push(u))}},e}},15:t=>{function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}t.exports=function(t){var r,n,i=(n=4,function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var n,i,a=[],o=!0,s=!1;try{for(r=r.call(t);!(o=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);o=!0);}catch(t){s=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(s)throw i}}return a}}(r,n)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[1],o=i[3];if(!o)return a;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),c="/*# ".concat(u," */"),l=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[a].concat(l).concat([c]).join("\n")}return[a].join("\n")}},376:(t,e,r)=>{function n(t,e){var r=t.__state.conversionName.toString(),n=Math.round(t.r),i=Math.round(t.g),a=Math.round(t.b),o=t.a,s=Math.round(t.h),u=t.s.toFixed(1),c=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===r||"SIX_CHAR_HEX"===r){for(var l=t.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===r?"rgb("+n+","+i+","+a+")":"CSS_RGBA"===r?"rgba("+n+","+i+","+a+","+o+")":"HEX"===r?"0x"+t.hex.toString(16):"RGB_ARRAY"===r?"["+n+","+i+","+a+"]":"RGBA_ARRAY"===r?"["+n+","+i+","+a+","+o+"]":"RGB_OBJ"===r?"{r:"+n+",g:"+i+",b:"+a+"}":"RGBA_OBJ"===r?"{r:"+n+",g:"+i+",b:"+a+",a:"+o+"}":"HSV_OBJ"===r?"{h:"+s+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===r?"{h:"+s+",s:"+u+",v:"+c+",a:"+o+"}":"unknown format"}r.r(e),r.d(e,{GUI:()=>mt,color:()=>lt,controllers:()=>ft,default:()=>pt,dom:()=>ht,gui:()=>dt});var i=Array.prototype.forEach,a=Array.prototype.slice,o={BREAK:{},extend:function(t){return this.each(a.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(r){this.isUndefined(e[r])||(t[r]=e[r])}.bind(this))}),this),t},defaults:function(t){return this.each(a.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(r){this.isUndefined(t[r])&&(t[r]=e[r])}.bind(this))}),this),t},compose:function(){var t=a.call(arguments);return function(){for(var e=a.call(arguments),r=t.length-1;r>=0;r--)e=[t[r].apply(this,e)];return e[0]}},each:function(t,e,r){if(t)if(i&&t.forEach&&t.forEach===i)t.forEach(e,r);else if(t.length===t.length+0){var n,a=void 0;for(a=0,n=t.length;a<n;a++)if(a in t&&e.call(r,t[a],a)===this.BREAK)return}else for(var o in t)if(e.call(r,t[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,r){var n=void 0;return function(){var i=this,a=arguments;function o(){n=null,r||t.apply(i,a)}var s=r||!n;clearTimeout(n),n=setTimeout(o,e),s&&t.apply(i,a)}},toArray:function(t){return t.toArray?t.toArray():a.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return isNaN(t)})),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return t instanceof Function}},s=[{litmus:o.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:n},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:n},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:n},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:n}}},{litmus:o.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:o.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:o.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(o.isNumber(t.r)&&o.isNumber(t.g)&&o.isNumber(t.b)&&o.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(o.isNumber(t.r)&&o.isNumber(t.g)&&o.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(o.isNumber(t.h)&&o.isNumber(t.s)&&o.isNumber(t.v)&&o.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(o.isNumber(t.h)&&o.isNumber(t.s)&&o.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],u=void 0,c=void 0,l=function(){c=!1;var t=arguments.length>1?o.toArray(arguments):arguments[0];return o.each(s,(function(e){if(e.litmus(t))return o.each(e.conversions,(function(e,r){if(u=e.read(t),!1===c&&!1!==u)return c=u,u.conversionName=r,u.conversion=e,o.BREAK})),o.BREAK})),c},f=void 0,h={hsv_to_rgb:function(t,e,r){var n=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),a=r*(1-e),o=r*(1-i*e),s=r*(1-(1-i)*e),u=[[r,s,a],[o,r,a],[a,r,s],[a,o,r],[s,a,r],[r,a,o]][n];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,r){var n=Math.min(t,e,r),i=Math.max(t,e,r),a=i-n,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=t===i?(e-r)/a:e===i?2+(r-t)/a:4+(t-e)/a,(o/=6)<0&&(o+=1),{h:360*o,s:a/i,v:i/255})},rgb_to_hex:function(t,e,r){var n=this.hex_with_component(0,2,t);return n=this.hex_with_component(n,1,e),this.hex_with_component(n,0,r)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,r){return r<<(f=8*e)|t&~(255<<f)}},d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},p=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},v=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},b=function(){function t(){if(m(this,t),this.__state=l.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return p(t,[{key:"toString",value:function(){return n(this)}},{key:"toHexString",value:function(){return n(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function y(t,e,r){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space||b.recalculateRGB(this,e,r),this.__state[e]},set:function(t){"RGB"!==this.__state.space&&(b.recalculateRGB(this,e,r),this.__state.space="RGB"),this.__state[e]=t}})}function M(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space||b.recalculateHSV(this),this.__state[e]},set:function(t){"HSV"!==this.__state.space&&(b.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}b.recalculateRGB=function(t,e,r){if("HEX"===t.__state.space)t.__state[e]=h.component_from_hex(t.__state.hex,r);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");o.extend(t.__state,h.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},b.recalculateHSV=function(t){var e=h.rgb_to_hsv(t.r,t.g,t.b);o.extend(t.__state,{s:e.s,v:e.v}),o.isNaN(e.h)?o.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},b.COMPONENTS=["r","g","b","h","s","v","hex","a"],y(b.prototype,"r",2),y(b.prototype,"g",1),y(b.prototype,"b",0),M(b.prototype,"h"),M(b.prototype,"s"),M(b.prototype,"v"),Object.defineProperty(b.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(b.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=h.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var x=function(){function t(e,r){m(this,t),this.initialValue=e[r],this.domElement=document.createElement("div"),this.object=e,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return p(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),w={};o.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(t,e){o.each(t,(function(t){w[t]=e}))}));var P=/(\d+(\.\d+)?)px/;function E(t){if("0"===t||o.isUndefined(t))return 0;var e=t.match(P);return o.isNull(e)?0:parseFloat(e[1])}var C={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,r){var n=r,i=e;o.isUndefined(i)&&(i=!0),o.isUndefined(n)&&(n=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),n&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,r,n){var i=r||{},a=w[e];if(!a)throw new Error("Event type "+e+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=i.x||i.clientX||0,c=i.y||i.clientY||0;s.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=s.initKeyboardEvent||s.initKeyEvent;o.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(e,i.bubbles||!1,i.cancelable||!0)}o.defaults(s,n),t.dispatchEvent(s)},bind:function(t,e,r,n){var i=n||!1;return t.addEventListener?t.addEventListener(e,r,i):t.attachEvent&&t.attachEvent("on"+e,r),C},unbind:function(t,e,r,n){var i=n||!1;return t.removeEventListener?t.removeEventListener(e,r,i):t.detachEvent&&t.detachEvent("on"+e,r),C},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var r=t.className.split(/ +/);-1===r.indexOf(e)&&(r.push(e),t.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return C},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var r=t.className.split(/ +/),n=r.indexOf(e);-1!==n&&(r.splice(n,1),t.className=r.join(" "))}else t.className=void 0;return C},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return E(e["border-left-width"])+E(e["border-right-width"])+E(e["padding-left"])+E(e["padding-right"])+E(e.width)},getHeight:function(t){var e=getComputedStyle(t);return E(e["border-top-width"])+E(e["border-bottom-width"])+E(e["padding-top"])+E(e["padding-bottom"])+E(e.height)},getOffset:function(t){var e=t,r={left:0,top:0};if(e.offsetParent)do{r.left+=e.offsetLeft,r.top+=e.offsetTop,e=e.offsetParent}while(e);return r},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},S=function(t){function e(t,r){m(this,e);var n=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),i=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),C.bind(n.__checkbox,"change",(function(){i.setValue(!i.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return v(e,t),p(e,[{key:"setValue",value:function(t){var r=_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(x),A=function(t){function e(t,r,n){m(this,e);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=n,s=i;if(i.__select=document.createElement("select"),o.isArray(a)){var u={};o.each(a,(function(t){u[t]=t})),a=u}return o.each(a,(function(t,e){var r=document.createElement("option");r.innerHTML=e,r.setAttribute("value",t),s.__select.appendChild(r)})),i.updateDisplay(),C.bind(i.__select,"change",(function(){var t=this.options[this.selectedIndex].value;s.setValue(t)})),i.domElement.appendChild(i.__select),i}return v(e,t),p(e,[{key:"setValue",value:function(t){var r=_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return C.isActive(this.__select)?this:(this.__select.value=this.getValue(),_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(x),O=function(t){function e(t,r){m(this,e);var n=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),i=n;function a(){i.setValue(i.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),C.bind(n.__input,"keyup",a),C.bind(n.__input,"change",a),C.bind(n.__input,"blur",(function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())})),C.bind(n.__input,"keydown",(function(t){13===t.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return v(e,t),p(e,[{key:"updateDisplay",value:function(){return C.isActive(this.__input)||(this.__input.value=this.getValue()),_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(x);function B(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var T=function(t){function e(t,r,n){m(this,e);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=n||{};return i.__min=a.min,i.__max=a.max,i.__step=a.step,o.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=B(i.__impliedStep),i}return v(e,t),p(e,[{key:"setValue",value:function(t){var r=t;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=B(t),this}}]),e}(x),F=function(t){function e(t,r,n){m(this,e);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,n));i.__truncationSuspended=!1;var a=i,s=void 0;function u(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(t){var e=s-t.clientY;a.setValue(a.getValue()+e*a.__impliedStep),s=t.clientY}function l(){C.unbind(window,"mousemove",c),C.unbind(window,"mouseup",l),u()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),C.bind(i.__input,"change",(function(){var t=parseFloat(a.__input.value);o.isNaN(t)||a.setValue(t)})),C.bind(i.__input,"blur",(function(){u()})),C.bind(i.__input,"mousedown",(function(t){C.bind(window,"mousemove",c),C.bind(window,"mouseup",l),s=t.clientY})),C.bind(i.__input,"keydown",(function(t){13===t.keyCode&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1,u())})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return v(e,t),p(e,[{key:"updateDisplay",value:function(){var t,r,n;return this.__input.value=this.__truncationSuspended?this.getValue():(t=this.getValue(),r=this.__precision,n=Math.pow(10,r),Math.round(t*n)/n),_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(T);function U(t,e,r,n,i){return n+(t-e)/(r-e)*(i-n)}var k=function(t){function e(t,r,n,i,a){m(this,e);var o=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:n,max:i,step:a})),s=o;function u(t){t.preventDefault();var e=s.__background.getBoundingClientRect();return s.setValue(U(t.clientX,e.left,e.right,s.__min,s.__max)),!1}function c(){C.unbind(window,"mousemove",u),C.unbind(window,"mouseup",c),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function l(t){var e=t.touches[0].clientX,r=s.__background.getBoundingClientRect();s.setValue(U(e,r.left,r.right,s.__min,s.__max))}function f(){C.unbind(window,"touchmove",l),C.unbind(window,"touchend",f),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),C.bind(o.__background,"mousedown",(function(t){document.activeElement.blur(),C.bind(window,"mousemove",u),C.bind(window,"mouseup",c),u(t)})),C.bind(o.__background,"touchstart",(function(t){1===t.touches.length&&(C.bind(window,"touchmove",l),C.bind(window,"touchend",f),l(t))})),C.addClass(o.__background,"slider"),C.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return v(e,t),p(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(T),I=function(t){function e(t,r,n){m(this,e);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===n?"Fire":n,C.bind(i.__button,"click",(function(t){return t.preventDefault(),a.fire(),!1})),C.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return v(e,t),p(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(x),R=function(t){function e(t,r){m(this,e);var n=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));n.__color=new b(n.getValue()),n.__temp=new b(0);var i=n;n.domElement=document.createElement("div"),C.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",C.bind(n.__input,"keydown",(function(t){13===t.keyCode&&d.call(this)})),C.bind(n.__input,"blur",d),C.bind(n.__selector,"mousedown",(function(){C.addClass(this,"drag").bind(window,"mouseup",(function(){C.removeClass(i.__selector,"drag")}))})),C.bind(n.__selector,"touchstart",(function(){C.addClass(this,"drag").bind(window,"touchend",(function(){C.removeClass(i.__selector,"drag")}))}));var a,s=document.createElement("div");function u(t){_(t),C.bind(window,"mousemove",_),C.bind(window,"touchmove",_),C.bind(window,"mouseup",f),C.bind(window,"touchend",f)}function c(t){v(t),C.bind(window,"mousemove",v),C.bind(window,"touchmove",v),C.bind(window,"mouseup",h),C.bind(window,"touchend",h)}function f(){C.unbind(window,"mousemove",_),C.unbind(window,"touchmove",_),C.unbind(window,"mouseup",f),C.unbind(window,"touchend",f),p()}function h(){C.unbind(window,"mousemove",v),C.unbind(window,"touchmove",v),C.unbind(window,"mouseup",h),C.unbind(window,"touchend",h),p()}function d(){var t=l(this.value);!1!==t?(i.__color.__state=t,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function p(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function _(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__saturation_field.getBoundingClientRect(),r=t.touches&&t.touches[0]||t,n=r.clientX,a=r.clientY,o=(n-e.left)/(e.right-e.left),s=1-(a-e.top)/(e.bottom-e.top);return s>1?s=1:s<0&&(s=0),o>1?o=1:o<0&&(o=0),i.__color.v=s,i.__color.s=o,i.setValue(i.__color.toOriginal()),!1}function v(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__hue_field.getBoundingClientRect(),r=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return r>1?r=1:r<0&&(r=0),i.__color.h=360*r,i.setValue(i.__color.toOriginal()),!1}return o.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),o.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),o.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),o.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),o.extend(s.style,{width:"100%",height:"100%",background:"none"}),V(s,"top","rgba(0,0,0,0)","#000"),o.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(a=n.__hue_field).style.background="",a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),C.bind(n.__saturation_field,"mousedown",u),C.bind(n.__saturation_field,"touchstart",u),C.bind(n.__field_knob,"mousedown",u),C.bind(n.__field_knob,"touchstart",u),C.bind(n.__hue_field,"mousedown",c),C.bind(n.__hue_field,"touchstart",c),n.__saturation_field.appendChild(s),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return v(e,t),p(e,[{key:"updateDisplay",value:function(){var t=l(this.getValue());if(!1!==t){var e=!1;o.each(b.COMPONENTS,(function(r){if(!o.isUndefined(t[r])&&!o.isUndefined(this.__color.__state[r])&&t[r]!==this.__color.__state[r])return e=!0,{}}),this),e&&o.extend(this.__color.__state,t)}o.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,n=255-r;o.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,V(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),o.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),e}(x),L=["-moz-","-o-","-webkit-","-ms-",""];function V(t,e,r,n){t.style.background="",o.each(L,(function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+r+" 0%, "+n+" 100%); "}))}var D='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',N=function(t,e){var r=t[e];return o.isArray(arguments[2])||o.isObject(arguments[2])?new A(t,e,arguments[2]):o.isNumber(r)?o.isNumber(arguments[2])&&o.isNumber(arguments[3])?o.isNumber(arguments[4])?new k(t,e,arguments[2],arguments[3],arguments[4]):new k(t,e,arguments[2],arguments[3]):o.isNumber(arguments[4])?new F(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new F(t,e,{min:arguments[2],max:arguments[3]}):o.isString(r)?new O(t,e):o.isFunction(r)?new I(t,e,""):o.isBoolean(r)?new S(t,e):null},G=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},q=function(){function t(){m(this,t),this.backgroundElement=document.createElement("div"),o.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),C.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),o.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;C.bind(this.backgroundElement,"click",(function(){e.hide()}))}return p(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),o.defer((function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",C.unbind(t.domElement,"webkitTransitionEnd",e),C.unbind(t.domElement,"transitionend",e),C.unbind(t.domElement,"oTransitionEnd",e)};C.bind(this.domElement,"webkitTransitionEnd",e),C.bind(this.domElement,"transitionend",e),C.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-C.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-C.getHeight(this.domElement)/2+"px"}}]),t}();!function(t,e){var r=e||document,n=document.createElement("style");n.type="text/css",n.innerHTML=t;var i=r.getElementsByTagName("head")[0];try{i.appendChild(n)}catch(t){}}(function(t){if("undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var H="Default",z=function(){try{return!!window.localStorage}catch(t){return!1}}(),j=void 0,X=!0,W=void 0,Y=!1,Q=[],Z=function t(e){var r=this,n=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),C.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=o.defaults(n,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),n=o.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),o.isUndefined(n.load)?n.load={preset:H}:n.preset&&(n.load.preset=n.preset),o.isUndefined(n.parent)&&n.hideable&&Q.push(this),n.resizable=o.isUndefined(n.parent)&&n.resizable,n.autoPlace&&o.isUndefined(n.scrollable)&&(n.scrollable=!0);var i,a=z&&"true"===localStorage.getItem(rt(0,"isLocal")),s=void 0,u=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return r.parent?r.getRoot().preset:n.load.preset},set:function(t){r.parent?r.getRoot().preset=t:n.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),r.revert()}},width:{get:function(){return n.width},set:function(t){n.width=t,st(r,t)}},name:{get:function(){return n.name},set:function(t){n.name=t,u&&(u.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(e){n.closed=e,n.closed?C.addClass(r.__ul,t.CLASS_CLOSED):C.removeClass(r.__ul,t.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return a},set:function(t){z&&(a=t,t?C.bind(window,"unload",s):C.unbind(window,"unload",s),localStorage.setItem(rt(0,"isLocal"),t))}}}),o.isUndefined(n.parent)){if(this.closed=n.closed||!1,C.addClass(this.domElement,t.CLASS_MAIN),C.makeSelectable(this.domElement,!1),z&&a){r.useLocalStorage=!0;var c=localStorage.getItem(rt(0,"gui"));c&&(n.load=JSON.parse(c))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,C.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),n.closeOnTop?(C.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(C.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),C.bind(this.__closeButton,"click",(function(){r.closed=!r.closed}))}else{void 0===n.closed&&(n.closed=!0);var l=document.createTextNode(n.name);C.addClass(l,"controller-name"),u=K(r,l),C.addClass(this.__ul,t.CLASS_CLOSED),C.addClass(u,"title"),C.bind(u,"click",(function(t){return t.preventDefault(),r.closed=!r.closed,!1})),n.closed||(this.closed=!1)}n.autoPlace&&(o.isUndefined(n.parent)&&(X&&(W=document.createElement("div"),C.addClass(W,"dg"),C.addClass(W,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(W),X=!1),W.appendChild(this.domElement),C.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||st(r,n.width)),this.__resizeHandler=function(){r.onResizeDebounced()},C.bind(window,"resize",this.__resizeHandler),C.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),C.bind(this.__ul,"transitionend",this.__resizeHandler),C.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&ot(this),s=function(){z&&"true"===localStorage.getItem(rt(0,"isLocal"))&&localStorage.setItem(rt(0,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=s,n.parent||((i=r.getRoot()).width+=1,o.defer((function(){i.width-=1})))};function K(t,e,r){var n=document.createElement("li");return e&&n.appendChild(e),r?t.__ul.insertBefore(n,r):t.__ul.appendChild(n),t.onResize(),n}function J(t){C.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&C.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function $(t,e){var r=t.__preset_select[t.__preset_select.selectedIndex];r.innerHTML=e?r.value+"*":r.value}function tt(t,e){var r=t.getRoot(),n=r.__rememberedObjects.indexOf(e.object);if(-1!==n){var i=r.__rememberedObjectIndecesToControllers[n];if(void 0===i&&(i={},r.__rememberedObjectIndecesToControllers[n]=i),i[e.property]=e,r.load&&r.load.remembered){var a=r.load.remembered,o=void 0;if(a[t.preset])o=a[t.preset];else{if(!a.Default)return;o=a.Default}if(o[n]&&void 0!==o[n][e.property]){var s=o[n][e.property];e.initialValue=s,e.setValue(s)}}}}function et(t,e,r,n){if(void 0===e[r])throw new Error('Object "'+e+'" has no property "'+r+'"');var i=void 0;if(n.color)i=new R(e,r);else{var a=[e,r].concat(n.factoryArgs);i=N.apply(t,a)}n.before instanceof x&&(n.before=n.before.__li),tt(t,i),C.addClass(i.domElement,"c");var s=document.createElement("span");C.addClass(s,"property-name"),s.innerHTML=i.property;var u=document.createElement("div");u.appendChild(s),u.appendChild(i.domElement);var c=K(t,u,n.before);return C.addClass(c,Z.CLASS_CONTROLLER_ROW),i instanceof R?C.addClass(c,"color"):C.addClass(c,d(i.getValue())),function(t,e,r){if(r.__li=e,r.__gui=t,o.extend(r,{options:function(e){if(arguments.length>1){var n=r.__li.nextElementSibling;return r.remove(),et(t,r.object,r.property,{before:n,factoryArgs:[o.toArray(arguments)]})}if(o.isArray(e)||o.isObject(e)){var i=r.__li.nextElementSibling;return r.remove(),et(t,r.object,r.property,{before:i,factoryArgs:[e]})}},name:function(t){return r.__li.firstElementChild.firstElementChild.innerHTML=t,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof k){var n=new F(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});o.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(t){var e=r[t],i=n[t];r[t]=n[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(n,t),e.apply(r,t)}})),C.addClass(e,"has-slider"),r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof F){var i=function(e){if(o.isNumber(r.__min)&&o.isNumber(r.__max)){var n=r.__li.firstElementChild.firstElementChild.innerHTML,i=r.__gui.__listening.indexOf(r)>-1;r.remove();var a=et(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]});return a.name(n),i&&a.listen(),a}return e};r.min=o.compose(i,r.min),r.max=o.compose(i,r.max)}else r instanceof S?(C.bind(e,"click",(function(){C.fakeEvent(r.__checkbox,"click")})),C.bind(r.__checkbox,"click",(function(t){t.stopPropagation()}))):r instanceof I?(C.bind(e,"click",(function(){C.fakeEvent(r.__button,"click")})),C.bind(e,"mouseover",(function(){C.addClass(r.__button,"hover")})),C.bind(e,"mouseout",(function(){C.removeClass(r.__button,"hover")}))):r instanceof R&&(C.addClass(e,"color"),r.updateDisplay=o.compose((function(t){return e.style.borderLeftColor=r.__color.toString(),t}),r.updateDisplay),r.updateDisplay());r.setValue=o.compose((function(e){return t.getRoot().__preset_select&&r.isModified()&&$(t.getRoot(),!0),e}),r.setValue)}(t,c,i),t.__controllers.push(i),i}function rt(t,e){return document.location.href+"."+e}function nt(t,e,r){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.__preset_select.appendChild(n),r&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function it(t,e){e.style.display=t.useLocalStorage?"block":"none"}function at(t){var e=t.__save_row=document.createElement("li");C.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),C.addClass(e,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",C.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save",C.addClass(n,"button"),C.addClass(n,"save");var i=document.createElement("span");i.innerHTML="New",C.addClass(i,"button"),C.addClass(i,"save-as");var a=document.createElement("span");a.innerHTML="Revert",C.addClass(a,"button"),C.addClass(a,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?o.each(t.load.remembered,(function(e,r){nt(t,r,r===t.preset)})):nt(t,H,!1),C.bind(s,"change",(function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value})),e.appendChild(s),e.appendChild(r),e.appendChild(n),e.appendChild(i),e.appendChild(a),z){var u=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(rt(0,"isLocal"))&&c.setAttribute("checked","checked"),it(t,u),C.bind(c,"change",(function(){t.useLocalStorage=!t.useLocalStorage,it(t,u)}))}var l=document.getElementById("dg-new-constructor");C.bind(l,"keydown",(function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||j.hide()})),C.bind(r,"click",(function(){l.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),j.show(),l.focus(),l.select()})),C.bind(n,"click",(function(){t.save()})),C.bind(i,"click",(function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)})),C.bind(a,"click",(function(){t.revert()}))}function ot(t){var e=void 0;function r(r){return r.preventDefault(),t.width+=e-r.clientX,t.onResize(),e=r.clientX,!1}function n(){C.removeClass(t.__closeButton,Z.CLASS_DRAG),C.unbind(window,"mousemove",r),C.unbind(window,"mouseup",n)}function i(i){return i.preventDefault(),e=i.clientX,C.addClass(t.__closeButton,Z.CLASS_DRAG),C.bind(window,"mousemove",r),C.bind(window,"mouseup",n),!1}t.__resize_handle=document.createElement("div"),o.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),C.bind(t.__resize_handle,"mousedown",i),C.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function st(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function ut(t,e){var r={};return o.each(t.__rememberedObjects,(function(n,i){var a={},s=t.__rememberedObjectIndecesToControllers[i];o.each(s,(function(t,r){a[r]=e?t.initialValue:t.getValue()})),r[i]=a})),r}function ct(t){0!==t.length&&G.call(window,(function(){ct(t)})),o.each(t,(function(t){t.updateDisplay()}))}Z.toggleHide=function(){Y=!Y,o.each(Q,(function(t){t.domElement.style.display=Y?"none":""}))},Z.CLASS_AUTO_PLACE="a",Z.CLASS_AUTO_PLACE_CONTAINER="ac",Z.CLASS_MAIN="main",Z.CLASS_CONTROLLER_ROW="cr",Z.CLASS_TOO_TALL="taller-than-window",Z.CLASS_CLOSED="closed",Z.CLASS_CLOSE_BUTTON="close-button",Z.CLASS_CLOSE_TOP="close-top",Z.CLASS_CLOSE_BOTTOM="close-bottom",Z.CLASS_DRAG="drag",Z.DEFAULT_WIDTH=245,Z.TEXT_CLOSED="Close Controls",Z.TEXT_OPEN="Open Controls",Z._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||Z.toggleHide()},C.bind(window,"keydown",Z._keydownHandler,!1),o.extend(Z.prototype,{add:function(t,e){return et(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return et(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;o.defer((function(){e.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&W.removeChild(this.domElement);var t=this;o.each(this.__folders,(function(e){t.removeFolder(e)})),C.unbind(window,"keydown",Z._keydownHandler,!1),J(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var r=new Z(e);this.__folders[t]=r;var n=K(this,r.domElement);return C.addClass(n,"folder"),r},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],J(t);var e=this;o.each(t.__folders,(function(e){t.removeFolder(e)})),o.defer((function(){e.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=C.getOffset(t.__ul).top,r=0;o.each(t.__ul.childNodes,(function(e){t.autoPlace&&e===t.__save_row||(r+=C.getHeight(e))})),window.innerHeight-e-20<r?(C.addClass(t.domElement,Z.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(C.removeClass(t.domElement,Z.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&o.defer((function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"})),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:o.debounce((function(){this.onResize()}),50),remember:function(){if(o.isUndefined(j)&&((j=new q).domElement.innerHTML=D),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;o.each(Array.prototype.slice.call(arguments),(function(e){0===t.__rememberedObjects.length&&at(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)})),this.autoPlace&&st(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=ut(this)),t.folders={},o.each(this.__folders,(function(e,r){t.folders[r]=e.getSaveObject()})),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ut(this),$(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=ut(this,!0)),this.load.remembered[t]=ut(this),this.preset=t,nt(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){o.each(this.__controllers,(function(e){this.getRoot().load.remembered?tt(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())}),this),o.each(this.__folders,(function(t){t.revert(t)})),t||$(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&ct(this.__listening)},updateDisplay:function(){o.each(this.__controllers,(function(t){t.updateDisplay()})),o.each(this.__folders,(function(t){t.updateDisplay()}))}});var lt={Color:b,math:h,interpret:l},ft={Controller:x,BooleanController:S,OptionController:A,StringController:O,NumberController:T,NumberControllerBox:F,NumberControllerSlider:k,FunctionController:I,ColorController:R},ht={dom:C},dt={GUI:Z},mt=Z;const pt={color:lt,controllers:ft,dom:ht,gui:dt,GUI:Z}},887:(t,e,r)=>{r.r(e),r.d(e,{glMatrix:()=>n,mat2:()=>i,mat2d:()=>a,mat3:()=>o,mat4:()=>s,quat:()=>l,quat2:()=>f,vec2:()=>h,vec3:()=>u,vec4:()=>c});var n={};r.r(n),r.d(n,{ARRAY_TYPE:()=>m,EPSILON:()=>d,RANDOM:()=>p,equals:()=>b,setMatrixArrayType:()=>_,toRadian:()=>g});var i={};r.r(i),r.d(i,{LDU:()=>L,add:()=>V,adjoint:()=>A,clone:()=>M,copy:()=>x,create:()=>y,determinant:()=>O,equals:()=>G,exactEquals:()=>N,frob:()=>R,fromRotation:()=>U,fromScaling:()=>k,fromValues:()=>P,identity:()=>w,invert:()=>S,mul:()=>z,multiply:()=>B,multiplyScalar:()=>q,multiplyScalarAndAdd:()=>H,rotate:()=>T,scale:()=>F,set:()=>E,str:()=>I,sub:()=>j,subtract:()=>D,transpose:()=>C});var a={};r.r(a),r.d(a,{add:()=>ct,clone:()=>W,copy:()=>Y,create:()=>X,determinant:()=>$,equals:()=>mt,exactEquals:()=>dt,frob:()=>ut,fromRotation:()=>it,fromScaling:()=>at,fromTranslation:()=>ot,fromValues:()=>Z,identity:()=>Q,invert:()=>J,mul:()=>pt,multiply:()=>tt,multiplyScalar:()=>ft,multiplyScalarAndAdd:()=>ht,rotate:()=>et,scale:()=>rt,set:()=>K,str:()=>st,sub:()=>_t,subtract:()=>lt,translate:()=>nt});var o={};r.r(o),r.d(o,{add:()=>Gt,adjoint:()=>Ct,clone:()=>bt,copy:()=>yt,create:()=>vt,determinant:()=>St,equals:()=>Xt,exactEquals:()=>jt,frob:()=>Nt,fromMat2d:()=>It,fromMat4:()=>gt,fromQuat:()=>Rt,fromRotation:()=>Ut,fromScaling:()=>kt,fromTranslation:()=>Ft,fromValues:()=>Mt,identity:()=>wt,invert:()=>Et,mul:()=>Wt,multiply:()=>At,multiplyScalar:()=>Ht,multiplyScalarAndAdd:()=>zt,normalFromMat4:()=>Lt,projection:()=>Vt,rotate:()=>Bt,scale:()=>Tt,set:()=>xt,str:()=>Dt,sub:()=>Yt,subtract:()=>qt,translate:()=>Ot,transpose:()=>Pt});var s={};r.r(s),r.d(s,{add:()=>Ve,adjoint:()=>ne,clone:()=>Zt,copy:()=>Kt,create:()=>Qt,determinant:()=>ie,equals:()=>He,exactEquals:()=>qe,frob:()=>Le,fromQuat:()=>Ee,fromQuat2:()=>be,fromRotation:()=>me,fromRotationTranslation:()=>ge,fromRotationTranslationScale:()=>we,fromRotationTranslationScaleOrigin:()=>Pe,fromScaling:()=>de,fromTranslation:()=>he,fromValues:()=>Jt,fromXRotation:()=>pe,fromYRotation:()=>_e,fromZRotation:()=>ve,frustum:()=>Ce,getRotation:()=>xe,getScaling:()=>Me,getTranslation:()=>ye,identity:()=>te,invert:()=>re,lookAt:()=>ke,mul:()=>ze,multiply:()=>ae,multiplyScalar:()=>Ne,multiplyScalarAndAdd:()=>Ge,ortho:()=>Fe,orthoNO:()=>Te,orthoZO:()=>Ue,perspective:()=>Ae,perspectiveFromFieldOfView:()=>Be,perspectiveNO:()=>Se,perspectiveZO:()=>Oe,rotate:()=>ue,rotateX:()=>ce,rotateY:()=>le,rotateZ:()=>fe,scale:()=>se,set:()=>$t,str:()=>Re,sub:()=>je,subtract:()=>De,targetTo:()=>Ie,translate:()=>oe,transpose:()=>ee});var u={};r.r(u),r.d(u,{add:()=>Je,angle:()=>Sr,bezier:()=>br,ceil:()=>rr,clone:()=>We,copy:()=>Ze,create:()=>Xe,cross:()=>_r,dist:()=>Rr,distance:()=>cr,div:()=>Ir,divide:()=>er,dot:()=>pr,equals:()=>Tr,exactEquals:()=>Br,floor:()=>nr,forEach:()=>Nr,fromValues:()=>Qe,hermite:()=>gr,inverse:()=>dr,len:()=>Vr,length:()=>Ye,lerp:()=>vr,max:()=>ar,min:()=>ir,mul:()=>kr,multiply:()=>tr,negate:()=>hr,normalize:()=>mr,random:()=>yr,rotateX:()=>Pr,rotateY:()=>Er,rotateZ:()=>Cr,round:()=>or,scale:()=>sr,scaleAndAdd:()=>ur,set:()=>Ke,sqrDist:()=>Lr,sqrLen:()=>Dr,squaredDistance:()=>lr,squaredLength:()=>fr,str:()=>Or,sub:()=>Ur,subtract:()=>$e,transformMat3:()=>xr,transformMat4:()=>Mr,transformQuat:()=>wr,zero:()=>Ar});var c={};r.r(c),r.d(c,{add:()=>Xr,ceil:()=>Zr,clone:()=>qr,copy:()=>zr,create:()=>Gr,cross:()=>hn,dist:()=>Pn,distance:()=>nn,div:()=>wn,divide:()=>Qr,dot:()=>fn,equals:()=>yn,exactEquals:()=>bn,floor:()=>Kr,forEach:()=>An,fromValues:()=>Hr,inverse:()=>cn,len:()=>Cn,length:()=>on,lerp:()=>dn,max:()=>$r,min:()=>Jr,mul:()=>xn,multiply:()=>Yr,negate:()=>un,normalize:()=>ln,random:()=>mn,round:()=>tn,scale:()=>en,scaleAndAdd:()=>rn,set:()=>jr,sqrDist:()=>En,sqrLen:()=>Sn,squaredDistance:()=>an,squaredLength:()=>sn,str:()=>gn,sub:()=>Mn,subtract:()=>Wr,transformMat4:()=>pn,transformQuat:()=>_n,zero:()=>vn});var l={};r.r(l),r.d(l,{add:()=>ai,calculateW:()=>Vn,clone:()=>ei,conjugate:()=>jn,copy:()=>ni,create:()=>On,dot:()=>ui,equals:()=>_i,exactEquals:()=>pi,exp:()=>Dn,fromEuler:()=>Wn,fromMat3:()=>Xn,fromValues:()=>ri,getAngle:()=>Un,getAxisAngle:()=>Fn,identity:()=>Bn,invert:()=>zn,len:()=>fi,length:()=>li,lerp:()=>ci,ln:()=>Nn,mul:()=>oi,multiply:()=>kn,normalize:()=>mi,pow:()=>Gn,random:()=>Hn,rotateX:()=>In,rotateY:()=>Rn,rotateZ:()=>Ln,rotationTo:()=>vi,scale:()=>si,set:()=>ii,setAxes:()=>bi,setAxisAngle:()=>Tn,slerp:()=>qn,sqlerp:()=>gi,sqrLen:()=>di,squaredLength:()=>hi,str:()=>Yn});var f={};r.r(f),r.d(f,{add:()=>Hi,clone:()=>Mi,conjugate:()=>Zi,copy:()=>Ai,create:()=>yi,dot:()=>Wi,equals:()=>ia,exactEquals:()=>na,fromMat4:()=>Si,fromRotation:()=>Ci,fromRotationTranslation:()=>Pi,fromRotationTranslationValues:()=>wi,fromTranslation:()=>Ei,fromValues:()=>xi,getDual:()=>Fi,getReal:()=>Ti,getTranslation:()=>Ii,identity:()=>Oi,invert:()=>Qi,len:()=>Ji,length:()=>Ki,lerp:()=>Yi,mul:()=>ji,multiply:()=>zi,normalize:()=>ea,rotateAroundAxis:()=>qi,rotateByQuatAppend:()=>Ni,rotateByQuatPrepend:()=>Gi,rotateX:()=>Li,rotateY:()=>Vi,rotateZ:()=>Di,scale:()=>Xi,set:()=>Bi,setDual:()=>ki,setReal:()=>Ui,sqrLen:()=>ta,squaredLength:()=>$i,str:()=>ra,translate:()=>Ri});var h={};r.r(h),r.d(h,{add:()=>la,angle:()=>La,ceil:()=>ma,clone:()=>oa,copy:()=>ua,create:()=>aa,cross:()=>Oa,dist:()=>Xa,distance:()=>Ma,div:()=>ja,divide:()=>da,dot:()=>Aa,equals:()=>Ga,exactEquals:()=>Na,floor:()=>pa,forEach:()=>Qa,fromValues:()=>sa,inverse:()=>Ca,len:()=>qa,length:()=>wa,lerp:()=>Ba,max:()=>va,min:()=>_a,mul:()=>za,multiply:()=>ha,negate:()=>Ea,normalize:()=>Sa,random:()=>Ta,rotate:()=>Ra,round:()=>ga,scale:()=>ba,scaleAndAdd:()=>ya,set:()=>ca,sqrDist:()=>Wa,sqrLen:()=>Ya,squaredDistance:()=>xa,squaredLength:()=>Pa,str:()=>Da,sub:()=>Ha,subtract:()=>fa,transformMat2:()=>Fa,transformMat2d:()=>Ua,transformMat3:()=>ka,transformMat4:()=>Ia,zero:()=>Va});var d=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function _(t){m=t}var v=Math.PI/180;function g(t){return t*v}function b(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function y(){var t=new m(4);return m!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function M(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function x(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function w(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function P(t,e,r,n){var i=new m(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function E(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function C(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function S(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*a-i*n;return o?(o=1/o,t[0]=a*o,t[1]=-n*o,t[2]=-i*o,t[3]=r*o,t):null}function A(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function O(t){return t[0]*t[3]-t[2]*t[1]}function B(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*s+a*u,t[1]=i*s+o*u,t[2]=n*c+a*l,t[3]=i*c+o*l,t}function T(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=i*u+o*s,t[2]=n*-s+a*u,t[3]=i*-s+o*u,t}function F(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=i*s,t[2]=a*u,t[3]=o*u,t}function U(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function k(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function I(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function R(t){return Math.hypot(t[0],t[1],t[2],t[3])}function L(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function V(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function D(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function N(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function G(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}function q(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function H(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var z=B,j=D;function X(){var t=new m(6);return m!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function W(t){var e=new m(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Q(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Z(t,e,r,n,i,a){var o=new m(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function K(t,e,r,n,i,a,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t}function J(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=r*a-n*i;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*s-a*o)*u,t[5]=(n*o-r*s)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1],f=r[2],h=r[3],d=r[4],m=r[5];return t[0]=n*c+a*l,t[1]=i*c+o*l,t[2]=n*f+a*h,t[3]=i*f+o*h,t[4]=n*d+a*m+s,t[5]=i*d+o*m+u,t}function et(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*c,t[1]=i*l+o*c,t[2]=n*-c+a*l,t[3]=i*-c+o*l,t[4]=s,t[5]=u,t}function rt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=i*c,t[2]=a*l,t[3]=o*l,t[4]=s,t[5]=u,t}function nt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=n*c+a*l+s,t[5]=i*c+o*l+u,t}function it(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function at(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function lt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function ft(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ht(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function mt(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],m=e[5];return Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=d*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-f)<=d*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-h)<=d*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))}var pt=tt,_t=lt;function vt(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new m(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Mt(t,e,r,n,i,a,o,s,u){var c=new m(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=u,c}function xt(t,e,r,n,i,a,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t}function wt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Pt(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Et(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*o-s*c,h=-l*a+s*u,d=c*a-o*u,m=r*f+n*h+i*d;return m?(m=1/m,t[0]=f*m,t[1]=(-l*n+i*c)*m,t[2]=(s*n-i*o)*m,t[3]=h*m,t[4]=(l*r-i*u)*m,t[5]=(-s*r+i*a)*m,t[6]=d*m,t[7]=(-c*r+n*u)*m,t[8]=(o*r-n*a)*m,t):null}function Ct(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=o*l-s*c,t[1]=i*c-n*l,t[2]=n*s-i*o,t[3]=s*u-a*l,t[4]=r*l-i*u,t[5]=i*a-r*s,t[6]=a*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*a,t}function St(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+r*(-c*i+o*s)+n*(u*i-a*s)}function At(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=r[0],d=r[1],m=r[2],p=r[3],_=r[4],v=r[5],g=r[6],b=r[7],y=r[8];return t[0]=h*n+d*o+m*c,t[1]=h*i+d*s+m*l,t[2]=h*a+d*u+m*f,t[3]=p*n+_*o+v*c,t[4]=p*i+_*s+v*l,t[5]=p*a+_*u+v*f,t[6]=g*n+b*o+y*c,t[7]=g*i+b*s+y*l,t[8]=g*a+b*u+y*f,t}function Ot(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=h*n+d*o+c,t[7]=h*i+d*s+l,t[8]=h*a+d*u+f,t}function Bt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*o,t[1]=d*i+h*s,t[2]=d*a+h*u,t[3]=d*o-h*n,t[4]=d*s-h*i,t[5]=d*u-h*a,t[6]=c,t[7]=l,t[8]=f,t}function Tt(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ft(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ut(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function kt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Rt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,u=i+i,c=r*o,l=n*o,f=n*s,h=i*o,d=i*s,m=i*u,p=a*o,_=a*s,v=a*u;return t[0]=1-f-m,t[3]=l-v,t[6]=h+_,t[1]=l+v,t[4]=1-c-m,t[7]=d-p,t[2]=h-_,t[5]=d+p,t[8]=1-c-f,t}function Lt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],_=e[14],v=e[15],g=r*s-n*o,b=r*u-i*o,y=r*c-a*o,M=n*u-i*s,x=n*c-a*s,w=i*c-a*u,P=l*p-f*m,E=l*_-h*m,C=l*v-d*m,S=f*_-h*p,A=f*v-d*p,O=h*v-d*_,B=g*O-b*A+y*S+M*C-x*E+w*P;return B?(B=1/B,t[0]=(s*O-u*A+c*S)*B,t[1]=(u*C-o*O-c*E)*B,t[2]=(o*A-s*C+c*P)*B,t[3]=(i*A-n*O-a*S)*B,t[4]=(r*O-i*C+a*E)*B,t[5]=(n*C-r*A-a*P)*B,t[6]=(p*w-_*x+v*M)*B,t[7]=(_*y-m*w-v*b)*B,t[8]=(m*x-p*y+v*g)*B,t):null}function Vt(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Dt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Nt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Gt(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function qt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Ht(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function zt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function jt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Xt(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=e[0],h=e[1],m=e[2],p=e[3],_=e[4],v=e[5],g=e[6],b=e[7],y=e[8];return Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-_)<=d*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-g)<=d*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-b)<=d*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-y)<=d*Math.max(1,Math.abs(l),Math.abs(y))}var Wt=At,Yt=qt;function Qt(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Zt(t){var e=new m(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Kt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,r,n,i,a,o,s,u,c,l,f,h,d,p,_){var v=new m(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=i,v[5]=a,v[6]=o,v[7]=s,v[8]=u,v[9]=c,v[10]=l,v[11]=f,v[12]=h,v[13]=d,v[14]=p,v[15]=_,v}function $t(t,e,r,n,i,a,o,s,u,c,l,f,h,d,m,p,_){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=f,t[11]=h,t[12]=d,t[13]=m,t[14]=p,t[15]=_,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],_=e[14],v=e[15],g=r*s-n*o,b=r*u-i*o,y=r*c-a*o,M=n*u-i*s,x=n*c-a*s,w=i*c-a*u,P=l*p-f*m,E=l*_-h*m,C=l*v-d*m,S=f*_-h*p,A=f*v-d*p,O=h*v-d*_,B=g*O-b*A+y*S+M*C-x*E+w*P;return B?(B=1/B,t[0]=(s*O-u*A+c*S)*B,t[1]=(i*A-n*O-a*S)*B,t[2]=(p*w-_*x+v*M)*B,t[3]=(h*x-f*w-d*M)*B,t[4]=(u*C-o*O-c*E)*B,t[5]=(r*O-i*C+a*E)*B,t[6]=(_*y-m*w-v*b)*B,t[7]=(l*w-h*y+d*b)*B,t[8]=(o*A-s*C+c*P)*B,t[9]=(n*C-r*A-a*P)*B,t[10]=(m*x-p*y+v*g)*B,t[11]=(f*y-l*x-d*g)*B,t[12]=(s*E-o*S-u*P)*B,t[13]=(r*S-n*E+i*P)*B,t[14]=(p*b-m*M-_*g)*B,t[15]=(l*M-f*b+h*g)*B,t):null}function ne(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],_=e[14],v=e[15];return t[0]=s*(h*v-d*_)-f*(u*v-c*_)+p*(u*d-c*h),t[1]=-(n*(h*v-d*_)-f*(i*v-a*_)+p*(i*d-a*h)),t[2]=n*(u*v-c*_)-s*(i*v-a*_)+p*(i*c-a*u),t[3]=-(n*(u*d-c*h)-s*(i*d-a*h)+f*(i*c-a*u)),t[4]=-(o*(h*v-d*_)-l*(u*v-c*_)+m*(u*d-c*h)),t[5]=r*(h*v-d*_)-l*(i*v-a*_)+m*(i*d-a*h),t[6]=-(r*(u*v-c*_)-o*(i*v-a*_)+m*(i*c-a*u)),t[7]=r*(u*d-c*h)-o*(i*d-a*h)+l*(i*c-a*u),t[8]=o*(f*v-d*p)-l*(s*v-c*p)+m*(s*d-c*f),t[9]=-(r*(f*v-d*p)-l*(n*v-a*p)+m*(n*d-a*f)),t[10]=r*(s*v-c*p)-o*(n*v-a*p)+m*(n*c-a*s),t[11]=-(r*(s*d-c*f)-o*(n*d-a*f)+l*(n*c-a*s)),t[12]=-(o*(f*_-h*p)-l*(s*_-u*p)+m*(s*h-u*f)),t[13]=r*(f*_-h*p)-l*(n*_-i*p)+m*(n*h-i*f),t[14]=-(r*(s*_-u*p)-o*(n*_-i*p)+m*(n*u-i*s)),t[15]=r*(s*h-u*f)-o*(n*h-i*f)+l*(n*u-i*s),t}function ie(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],m=t[13],p=t[14],_=t[15];return(e*o-r*a)*(f*_-h*p)-(e*s-n*a)*(l*_-h*m)+(e*u-i*a)*(l*p-f*m)+(r*s-n*o)*(c*_-h*d)-(r*u-i*o)*(c*p-f*d)+(n*u-i*s)*(c*m-l*d)}function ae(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],m=e[11],p=e[12],_=e[13],v=e[14],g=e[15],b=r[0],y=r[1],M=r[2],x=r[3];return t[0]=b*n+y*s+M*f+x*p,t[1]=b*i+y*u+M*h+x*_,t[2]=b*a+y*c+M*d+x*v,t[3]=b*o+y*l+M*m+x*g,b=r[4],y=r[5],M=r[6],x=r[7],t[4]=b*n+y*s+M*f+x*p,t[5]=b*i+y*u+M*h+x*_,t[6]=b*a+y*c+M*d+x*v,t[7]=b*o+y*l+M*m+x*g,b=r[8],y=r[9],M=r[10],x=r[11],t[8]=b*n+y*s+M*f+x*p,t[9]=b*i+y*u+M*h+x*_,t[10]=b*a+y*c+M*d+x*v,t[11]=b*o+y*l+M*m+x*g,b=r[12],y=r[13],M=r[14],x=r[15],t[12]=b*n+y*s+M*f+x*p,t[13]=b*i+y*u+M*h+x*_,t[14]=b*a+y*c+M*d+x*v,t[15]=b*o+y*l+M*m+x*g,t}function oe(t,e,r){var n,i,a,o,s,u,c,l,f,h,d,m,p=r[0],_=r[1],v=r[2];return e===t?(t[12]=e[0]*p+e[4]*_+e[8]*v+e[12],t[13]=e[1]*p+e[5]*_+e[9]*v+e[13],t[14]=e[2]*p+e[6]*_+e[10]*v+e[14],t[15]=e[3]*p+e[7]*_+e[11]*v+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],m=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=m,t[12]=n*p+s*_+f*v+e[12],t[13]=i*p+u*_+h*v+e[13],t[14]=a*p+c*_+d*v+e[14],t[15]=o*p+l*_+m*v+e[15]),t}function se(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){var i,a,o,s,u,c,l,f,h,m,p,_,v,g,b,y,M,x,w,P,E,C,S,A,O=n[0],B=n[1],T=n[2],F=Math.hypot(O,B,T);return F<d?null:(O*=F=1/F,B*=F,T*=F,i=Math.sin(r),o=1-(a=Math.cos(r)),s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],m=e[6],p=e[7],_=e[8],v=e[9],g=e[10],b=e[11],y=O*O*o+a,M=B*O*o+T*i,x=T*O*o-B*i,w=O*B*o-T*i,P=B*B*o+a,E=T*B*o+O*i,C=O*T*o+B*i,S=B*T*o-O*i,A=T*T*o+a,t[0]=s*y+f*M+_*x,t[1]=u*y+h*M+v*x,t[2]=c*y+m*M+g*x,t[3]=l*y+p*M+b*x,t[4]=s*w+f*P+_*E,t[5]=u*w+h*P+v*E,t[6]=c*w+m*P+g*E,t[7]=l*w+p*P+b*E,t[8]=s*C+f*S+_*A,t[9]=u*C+h*S+v*A,t[10]=c*C+m*S+g*A,t[11]=l*C+p*S+b*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*n,t[5]=o*i+l*n,t[6]=s*i+f*n,t[7]=u*i+h*n,t[8]=c*i-a*n,t[9]=l*i-o*n,t[10]=f*i-s*n,t[11]=h*i-u*n,t}function le(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*n,t[1]=o*i-l*n,t[2]=s*i-f*n,t[3]=u*i-h*n,t[8]=a*n+c*i,t[9]=o*n+l*i,t[10]=s*n+f*i,t[11]=u*n+h*i,t}function fe(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*n,t[1]=o*i+l*n,t[2]=s*i+f*n,t[3]=u*i+h*n,t[4]=c*i-a*n,t[5]=l*i-o*n,t[6]=f*i-s*n,t[7]=h*i-u*n,t}function he(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e,r){var n,i,a,o=r[0],s=r[1],u=r[2],c=Math.hypot(o,s,u);return c<d?null:(o*=c=1/c,s*=c,u*=c,n=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=s*o*a+u*n,t[2]=u*o*a-s*n,t[3]=0,t[4]=o*s*a-u*n,t[5]=s*s*a+i,t[6]=u*s*a+o*n,t[7]=0,t[8]=o*u*a+s*n,t[9]=s*u*a-o*n,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,u=i+i,c=a+a,l=n*s,f=n*u,h=n*c,d=i*u,m=i*c,p=a*c,_=o*s,v=o*u,g=o*c;return t[0]=1-(d+p),t[1]=f+g,t[2]=h-v,t[3]=0,t[4]=f-g,t[5]=1-(l+p),t[6]=m+_,t[7]=0,t[8]=h+v,t[9]=m-_,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e){var r=new m(3),n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=n*n+i*i+a*a+o*o;return f>0?(r[0]=2*(s*o+l*n+u*a-c*i)/f,r[1]=2*(u*o+l*i+c*n-s*a)/f,r[2]=2*(c*o+l*a+s*i-u*n)/f):(r[0]=2*(s*o+l*n+u*a-c*i),r[1]=2*(u*o+l*i+c*n-s*a),r[2]=2*(c*o+l*a+s*i-u*n)),ge(t,e,r),t}function ye(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Me(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,c,l),t}function xe(t,e){var r=new m(3);Me(r,e);var n=1/r[0],i=1/r[1],a=1/r[2],o=e[0]*n,s=e[1]*i,u=e[2]*a,c=e[4]*n,l=e[5]*i,f=e[6]*a,h=e[8]*n,d=e[9]*i,p=e[10]*a,_=o+l+p,v=0;return _>0?(v=2*Math.sqrt(_+1),t[3]=.25*v,t[0]=(f-d)/v,t[1]=(h-u)/v,t[2]=(s-c)/v):o>l&&o>p?(v=2*Math.sqrt(1+o-l-p),t[3]=(f-d)/v,t[0]=.25*v,t[1]=(s+c)/v,t[2]=(h+u)/v):l>p?(v=2*Math.sqrt(1+l-o-p),t[3]=(h-u)/v,t[0]=(s+c)/v,t[1]=.25*v,t[2]=(f+d)/v):(v=2*Math.sqrt(1+p-o-l),t[3]=(s-c)/v,t[0]=(h+u)/v,t[1]=(f+d)/v,t[2]=.25*v),t}function we(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,l=o+o,f=i*u,h=i*c,d=i*l,m=a*c,p=a*l,_=o*l,v=s*u,g=s*c,b=s*l,y=n[0],M=n[1],x=n[2];return t[0]=(1-(m+_))*y,t[1]=(h+b)*y,t[2]=(d-g)*y,t[3]=0,t[4]=(h-b)*M,t[5]=(1-(f+_))*M,t[6]=(p+v)*M,t[7]=0,t[8]=(d+g)*x,t[9]=(p-v)*x,t[10]=(1-(f+m))*x,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Pe(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,l=o+o,f=s+s,h=a*c,d=a*l,m=a*f,p=o*l,_=o*f,v=s*f,g=u*c,b=u*l,y=u*f,M=n[0],x=n[1],w=n[2],P=i[0],E=i[1],C=i[2],S=(1-(p+v))*M,A=(d+y)*M,O=(m-b)*M,B=(d-y)*x,T=(1-(h+v))*x,F=(_+g)*x,U=(m+b)*w,k=(_-g)*w,I=(1-(h+p))*w;return t[0]=S,t[1]=A,t[2]=O,t[3]=0,t[4]=B,t[5]=T,t[6]=F,t[7]=0,t[8]=U,t[9]=k,t[10]=I,t[11]=0,t[12]=r[0]+P-(S*P+B*E+U*C),t[13]=r[1]+E-(A*P+T*E+k*C),t[14]=r[2]+C-(O*P+F*E+I*C),t[15]=1,t}function Ee(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,u=i+i,c=r*o,l=n*o,f=n*s,h=i*o,d=i*s,m=i*u,p=a*o,_=a*s,v=a*u;return t[0]=1-f-m,t[1]=l+v,t[2]=h-_,t[3]=0,t[4]=l-v,t[5]=1-c-m,t[6]=d+p,t[7]=0,t[8]=h+_,t[9]=d-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ce(t,e,r,n,i,a,o){var s=1/(r-e),u=1/(i-n),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function Se(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var Ae=Se;function Oe(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function Be(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Te(t,e,r,n,i,a,o){var s=1/(e-r),u=1/(n-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=(o+a)*c,t[15]=1,t}var Fe=Te;function Ue(t,e,r,n,i,a,o){var s=1/(e-r),u=1/(n-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=a*c,t[15]=1,t}function ke(t,e,r,n){var i,a,o,s,u,c,l,f,h,m,p=e[0],_=e[1],v=e[2],g=n[0],b=n[1],y=n[2],M=r[0],x=r[1],w=r[2];return Math.abs(p-M)<d&&Math.abs(_-x)<d&&Math.abs(v-w)<d?te(t):(l=p-M,f=_-x,h=v-w,i=b*(h*=m=1/Math.hypot(l,f,h))-y*(f*=m),a=y*(l*=m)-g*h,o=g*f-b*l,(m=Math.hypot(i,a,o))?(i*=m=1/m,a*=m,o*=m):(i=0,a=0,o=0),s=f*o-h*a,u=h*i-l*o,c=l*a-f*i,(m=Math.hypot(s,u,c))?(s*=m=1/m,u*=m,c*=m):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=a,t[5]=u,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+a*_+o*v),t[13]=-(s*p+u*_+c*v),t[14]=-(l*p+f*_+h*v),t[15]=1,t)}function Ie(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=n[0],u=n[1],c=n[2],l=i-r[0],f=a-r[1],h=o-r[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);var m=u*h-c*f,p=c*l-s*h,_=s*f-u*l;return(d=m*m+p*p+_*_)>0&&(m*=d=1/Math.sqrt(d),p*=d,_*=d),t[0]=m,t[1]=p,t[2]=_,t[3]=0,t[4]=f*_-h*p,t[5]=h*m-l*_,t[6]=l*p-f*m,t[7]=0,t[8]=l,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function Re(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Le(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ve(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function De(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Ne(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Ge(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function qe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function He(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],m=t[11],p=t[12],_=t[13],v=t[14],g=t[15],b=e[0],y=e[1],M=e[2],x=e[3],w=e[4],P=e[5],E=e[6],C=e[7],S=e[8],A=e[9],O=e[10],B=e[11],T=e[12],F=e[13],U=e[14],k=e[15];return Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-y)<=d*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-M)<=d*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-x)<=d*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-w)<=d*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-P)<=d*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(u-E)<=d*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-C)<=d*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(l-S)<=d*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(f-A)<=d*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(h-O)<=d*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(m-B)<=d*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(p-T)<=d*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(_-F)<=d*Math.max(1,Math.abs(_),Math.abs(F))&&Math.abs(v-U)<=d*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(g-k)<=d*Math.max(1,Math.abs(g),Math.abs(k))}var ze=ae,je=De;function Xe(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function We(t){var e=new m(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ye(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Qe(t,e,r){var n=new m(3);return n[0]=t,n[1]=e,n[2]=r,n}function Ze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ke(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Je(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function $e(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function tr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function er(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function rr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function nr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function ir(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function ar(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function or(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function sr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ur(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function cr(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function lr(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function fr(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function hr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function dr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function mr(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function pr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _r(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2];return t[0]=i*u-a*s,t[1]=a*o-n*u,t[2]=n*s-i*o,t}function vr(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t}function gr(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),l=o*(3-2*a);return t[0]=e[0]*s+r[0]*u+n[0]*c+i[0]*l,t[1]=e[1]*s+r[1]*u+n[1]*c+i[1]*l,t[2]=e[2]*s+r[2]*u+n[2]*c+i[2]*l,t}function br(t,e,r,n,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,l=3*a*s,f=3*u*o,h=u*a;return t[0]=e[0]*c+r[0]*l+n[0]*f+i[0]*h,t[1]=e[1]*c+r[1]*l+n[1]*f+i[1]*h,t[2]=e[2]*c+r[2]*l+n[2]*f+i[2]*h,t}function yr(t,e){e=e||1;var r=2*p()*Math.PI,n=2*p()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function Mr(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t}function xr(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function wr(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],u=e[1],c=e[2],l=i*c-a*u,f=a*s-n*c,h=n*u-i*s,d=i*h-a*f,m=a*l-n*h,p=n*f-i*l,_=2*o;return l*=_,f*=_,h*=_,d*=2,m*=2,p*=2,t[0]=s+l+d,t[1]=u+f+m,t[2]=c+h+p,t}function Pr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Er(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Cr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Sr(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+o*o+s*s),c=u&&pr(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t}function Or(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Br(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Tr(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Fr,Ur=$e,kr=tr,Ir=er,Rr=cr,Lr=lr,Vr=Ye,Dr=fr,Nr=(Fr=Xe(),function(t,e,r,n,i,a){var o,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)Fr[0]=t[o],Fr[1]=t[o+1],Fr[2]=t[o+2],i(Fr,Fr,a),t[o]=Fr[0],t[o+1]=Fr[1],t[o+2]=Fr[2];return t});function Gr(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function qr(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Hr(t,e,r,n){var i=new m(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function zr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function jr(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function Xr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Wr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Yr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Qr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Zr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Kr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Jr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function $r(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function tn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function en(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function rn(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function nn(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,n,i,a)}function an(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function on(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function sn(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function un(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function cn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ln(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}function fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function hn(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],l=e[0],f=e[1],h=e[2],d=e[3];return t[0]=f*c-h*u+d*s,t[1]=-l*c+h*o-d*a,t[2]=l*u-f*o+d*i,t[3]=-l*s+f*a-h*i,t}function dn(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t}function mn(t,e){var r,n,i,a,o,s;e=e||1;do{o=(r=2*p()-1)*r+(n=2*p()-1)*n}while(o>=1);do{s=(i=2*p()-1)*i+(a=2*p()-1)*a}while(s>=1);var u=Math.sqrt((1-o)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*u,t[3]=e*a*u,t}function pn(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t}function _n(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*a-u*i,f=c*i+u*n-o*a,h=c*a+o*i-s*n,d=-o*n-s*i-u*a;return t[0]=l*c+d*-o+f*-u-h*-s,t[1]=f*c+d*-s+h*-o-l*-u,t[2]=h*c+d*-u+l*-s-f*-o,t[3]=e[3],t}function vn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function gn(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function bn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function yn(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}var Mn=Wr,xn=Yr,wn=Qr,Pn=nn,En=an,Cn=on,Sn=sn,An=function(){var t=Gr();return function(e,r,n,i,a,o){var s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function On(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Bn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Tn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Fn(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>d?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function Un(t,e){var r=ui(t,e);return Math.acos(2*r*r-1)}function kn(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-n*c,t[2]=a*l+o*c+n*u-i*s,t[3]=o*l-n*s-i*u-a*c,t}function In(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-n*s,t}function Rn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-a*s,t[1]=i*u+o*s,t[2]=a*u+n*s,t[3]=o*u-i*s,t}function Ln(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=i*u-n*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function Vn(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function Dn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return t[0]=r*u,t[1]=n*u,t[2]=i*u,t[3]=s*Math.cos(o),t}function Nn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=.5*Math.log(r*r+n*n+i*i+a*a),t}function Gn(t,e,r){return Nn(t,e),si(t,t,r),Dn(t,t),t}function qn(t,e,r,n){var i,a,o,s,u,c=e[0],l=e[1],f=e[2],h=e[3],m=r[0],p=r[1],_=r[2],v=r[3];return(a=c*m+l*p+f*_+h*v)<0&&(a=-a,m=-m,p=-p,_=-_,v=-v),1-a>d?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(s=1-n,u=n),t[0]=s*c+u*m,t[1]=s*l+u*p,t[2]=s*f+u*_,t[3]=s*h+u*v,t}function Hn(t){var e=p(),r=p(),n=p(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t}function zn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function jn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Xn(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+o]-e[3*o+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t}function Wn(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return t[0]=a*u*l-o*s*c,t[1]=o*s*l+a*u*c,t[2]=o*u*c-a*s*l,t[3]=o*u*l+a*s*c,t}function Yn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Qn,Zn,Kn,Jn,$n,ti,ei=qr,ri=Hr,ni=zr,ii=jr,ai=Xr,oi=kn,si=en,ui=fn,ci=dn,li=on,fi=li,hi=sn,di=hi,mi=ln,pi=bn,_i=yn,vi=(Qn=Xe(),Zn=Qe(1,0,0),Kn=Qe(0,1,0),function(t,e,r){var n=pr(e,r);return n<-.999999?(_r(Qn,Zn,e),Vr(Qn)<1e-6&&_r(Qn,Kn,e),mr(Qn,Qn),Tn(t,Qn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(_r(Qn,e,r),t[0]=Qn[0],t[1]=Qn[1],t[2]=Qn[2],t[3]=1+n,mi(t,t))}),gi=(Jn=On(),$n=On(),function(t,e,r,n,i,a){return qn(Jn,e,i,a),qn($n,r,n,a),qn(t,Jn,$n,2*a*(1-a)),t}),bi=(ti=vt(),function(t,e,r,n){return ti[0]=r[0],ti[3]=r[1],ti[6]=r[2],ti[1]=n[0],ti[4]=n[1],ti[7]=n[2],ti[2]=-e[0],ti[5]=-e[1],ti[8]=-e[2],mi(t,Xn(t,ti))});function yi(){var t=new m(8);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Mi(t){var e=new m(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function xi(t,e,r,n,i,a,o,s){var u=new m(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u}function wi(t,e,r,n,i,a,o){var s=new m(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;var u=.5*i,c=.5*a,l=.5*o;return s[4]=u*n+c*r-l*e,s[5]=c*n+l*t-u*r,s[6]=l*n+u*e-c*t,s[7]=-u*t-c*e-l*r,s}function Pi(t,e,r){var n=.5*r[0],i=.5*r[1],a=.5*r[2],o=e[0],s=e[1],u=e[2],c=e[3];return t[0]=o,t[1]=s,t[2]=u,t[3]=c,t[4]=n*c+i*u-a*s,t[5]=i*c+a*o-n*u,t[6]=a*c+n*s-i*o,t[7]=-n*o-i*s-a*u,t}function Ei(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function Ci(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Si(t,e){var r=On();xe(r,e);var n=new m(3);return ye(n,e),Pi(t,r,n),t}function Ai(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Oi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Bi(t,e,r,n,i,a,o,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t}var Ti=ni;function Fi(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Ui=ni;function ki(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Ii(t,e){var r=e[4],n=e[5],i=e[6],a=e[7],o=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(r*c+a*o+n*u-i*s),t[1]=2*(n*c+a*s+i*o-r*u),t[2]=2*(i*c+a*u+r*s-n*o),t}function Ri(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],l=e[4],f=e[5],h=e[6],d=e[7];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=o*s+i*c-a*u+l,t[5]=o*u+a*s-n*c+f,t[6]=o*c+n*u-i*s+h,t[7]=-n*s-i*u-a*c+d,t}function Li(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,m=l*o-s*n-u*i-c*a;return In(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+m*n+h*a-d*i,t[5]=h*o+m*i+d*n-f*a,t[6]=d*o+m*a+f*i-h*n,t[7]=m*o-f*n-h*i-d*a,t}function Vi(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,m=l*o-s*n-u*i-c*a;return Rn(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+m*n+h*a-d*i,t[5]=h*o+m*i+d*n-f*a,t[6]=d*o+m*a+f*i-h*n,t[7]=m*o-f*n-h*i-d*a,t}function Di(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,m=l*o-s*n-u*i-c*a;return Ln(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+m*n+h*a-d*i,t[5]=h*o+m*i+d*n-f*a,t[6]=d*o+m*a+f*i-h*n,t[7]=m*o-f*n-h*i-d*a,t}function Ni(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=s*o+l*n+u*a-c*i,t[1]=u*o+l*i+c*n-s*a,t[2]=c*o+l*a+s*i-u*n,t[3]=l*o-s*n-u*i-c*a,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=s*o+l*n+u*a-c*i,t[5]=u*o+l*i+c*n-s*a,t[6]=c*o+l*a+s*i-u*n,t[7]=l*o-s*n-u*i-c*a,t}function Gi(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-n*c,t[2]=a*l+o*c+n*u-i*s,t[3]=o*l-n*s-i*u-a*c,s=r[4],u=r[5],c=r[6],l=r[7],t[4]=n*l+o*s+i*c-a*u,t[5]=i*l+o*u+a*s-n*c,t[6]=a*l+o*c+n*u-i*s,t[7]=o*l-n*s-i*u-a*c,t}function qi(t,e,r,n){if(Math.abs(n)<d)return Ai(t,e);var i=Math.hypot(r[0],r[1],r[2]);n*=.5;var a=Math.sin(n),o=a*r[0]/i,s=a*r[1]/i,u=a*r[2]/i,c=Math.cos(n),l=e[0],f=e[1],h=e[2],m=e[3];t[0]=l*c+m*o+f*u-h*s,t[1]=f*c+m*s+h*o-l*u,t[2]=h*c+m*u+l*s-f*o,t[3]=m*c-l*o-f*s-h*u;var p=e[4],_=e[5],v=e[6],g=e[7];return t[4]=p*c+g*o+_*u-v*s,t[5]=_*c+g*s+v*o-p*u,t[6]=v*c+g*u+p*s-_*o,t[7]=g*c-p*o-_*s-v*u,t}function Hi(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function zi(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[4],u=r[5],c=r[6],l=r[7],f=e[4],h=e[5],d=e[6],m=e[7],p=r[0],_=r[1],v=r[2],g=r[3];return t[0]=n*g+o*p+i*v-a*_,t[1]=i*g+o*_+a*p-n*v,t[2]=a*g+o*v+n*_-i*p,t[3]=o*g-n*p-i*_-a*v,t[4]=n*l+o*s+i*c-a*u+f*g+m*p+h*v-d*_,t[5]=i*l+o*u+a*s-n*c+h*g+m*_+d*p-f*v,t[6]=a*l+o*c+n*u-i*s+d*g+m*v+f*_-h*p,t[7]=o*l-n*s-i*u-a*c+m*g-f*p-h*_-d*v,t}var ji=zi;function Xi(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var Wi=ui;function Yi(t,e,r,n){var i=1-n;return Wi(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t}function Qi(t,e){var r=$i(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Zi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ki=li,Ji=Ki,$i=hi,ta=$i;function ea(t,e){var r=$i(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,i=e[1]/r,a=e[2]/r,o=e[3]/r,s=e[4],u=e[5],c=e[6],l=e[7],f=n*s+i*u+a*c+o*l;t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=(s-n*f)/r,t[5]=(u-i*f)/r,t[6]=(c-a*f)/r,t[7]=(l-o*f)/r}return t}function ra(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function na(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ia(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=e[0],f=e[1],h=e[2],m=e[3],p=e[4],_=e[5],v=e[6],g=e[7];return Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-h)<=d*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-m)<=d*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-_)<=d*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-v)<=d*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))}function aa(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}function oa(t){var e=new m(2);return e[0]=t[0],e[1]=t[1],e}function sa(t,e){var r=new m(2);return r[0]=t,r[1]=e,r}function ua(t,e){return t[0]=e[0],t[1]=e[1],t}function ca(t,e,r){return t[0]=e,t[1]=r,t}function la(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function fa(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function ha(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function da(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function ma(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function pa(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function _a(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function va(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function ga(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function ba(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function ya(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function Ma(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function xa(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function wa(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function Pa(t){var e=t[0],r=t[1];return e*e+r*r}function Ea(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Ca(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Sa(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Aa(t,e){return t[0]*e[0]+t[1]*e[1]}function Oa(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function Ba(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function Ta(t,e){e=e||1;var r=2*p()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function Fa(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function Ua(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function ka(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function Ia(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function Ra(t,e,r,n){var i=e[0]-r[0],a=e[1]-r[1],o=Math.sin(n),s=Math.cos(n);return t[0]=i*s-a*o+r[0],t[1]=i*o+a*s+r[1],t}function La(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],o=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a),s=o&&(r*i+n*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}function Va(t){return t[0]=0,t[1]=0,t}function Da(t){return"vec2("+t[0]+", "+t[1]+")"}function Na(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ga(t,e){var r=t[0],n=t[1],i=e[0],a=e[1];return Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))}var qa=wa,Ha=fa,za=ha,ja=da,Xa=Ma,Wa=xa,Ya=Pa,Qa=function(){var t=aa();return function(e,r,n,i,a,o){var s,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}()},275:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="fn rand(seed : vec2<f32>) -> f32 {\r\n\treturn fract(sin(dot(seed, vec2<f32>(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfn randUnitVec3(seed: f32, idx: f32) -> vec3<f32> {\r\n    var result = vec3<f32>();\r\n    result.x = rand(vec2<f32>(seed*idx, seed));\r\n    result.y = rand(vec2<f32>(result.x, idx));\r\n    result.z = rand(vec2<f32>(idx, result.y));\r\n    result = (result * 2) - 1;\r\n    return normalize(result);\r\n}\r\n\r\nstruct Particle {\r\n    position: vec3<f32>,\r\n    lifetime: f32,\r\n    velocity: vec3<f32>\r\n}\r\n\r\nstruct Particles {\r\n  particles : array<Particle>\r\n};\r\n\r\nstruct SimulationParams {\r\n    deltaTime: f32,\r\n    gravity: vec3<f32>,\r\n    origin: vec3<f32>,\r\n    minLifetime: f32,\r\n    maxLifetime: f32,\r\n    initialVelocity: f32,\r\n    randSeed: f32,\r\n    maxIdx: u32 //todo: change type if uint doesn't work\r\n}\r\n\r\n@binding(0) @group(0) var<storage, read_write> data : Particles;\r\n@binding(1) @group(0) var<uniform> params : SimulationParams;\r\n\r\n@compute @workgroup_size(256)\r\nfn simulate(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\r\n    let idx = GlobalInvocationID.x;\r\n\r\n    // load particle from buffer\r\n    var particle = data.particles[idx];\r\n\r\n    //reset expired particles\r\n    if (particle.lifetime <= 0) {\r\n        if(params.maxIdx != 0 && idx > params.maxIdx) {\r\n            return;\r\n        }\r\n\r\n        particle.lifetime = params.minLifetime + (params.maxLifetime - params.minLifetime) * rand(vec2<f32>(params.randSeed, f32(idx)));\r\n        particle.position = params.origin;\r\n\r\n        var velocityAbs = params.initialVelocity;\r\n        velocityAbs = velocityAbs * (rand(vec2<f32>(params.randSeed, f32(idx)) - 0.5));    // velocity += 50% => v * (r - 1/2)\r\n        particle.velocity = vec3<f32>(0,0,0);\r\n        particle.velocity = randUnitVec3(params.randSeed, f32(idx)) * velocityAbs;\r\n    }\r\n\r\n    // apply gravity\r\n    particle.velocity = particle.velocity + (params.gravity * params.deltaTime);\r\n\r\n    // update particle data\r\n    particle.position = particle.position + (particle.velocity * params.deltaTime);\r\n    particle.lifetime = particle.lifetime - params.deltaTime;\r\n\r\n    // write updated particle data into buffer\r\n    data.particles[idx] = particle;\r\n}\r\n"},147:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="struct Uniforms {\r\n  halfwidth: f32,\r\n  halfheight : f32\r\n};\r\n\r\nstruct Camera {\r\n    viewProjectionMatrix: mat4x4<f32>\r\n};\r\n\r\nstruct Particle {\r\n    position: vec3<f32>,\r\n    lifetime: f32,\r\n    velocity: vec3<f32>\r\n}\r\n\r\nstruct Particles {\r\n  particles : array<Particle>\r\n};\r\n\r\n@binding(0) @group(0) var<uniform> uniforms : Uniforms;\r\n@binding(1) @group(0) var<uniform> camera: Camera;\r\n@binding(0) @group(1) var<storage, read> particleBuffer : Particles;\r\n\r\nstruct VertexInput {\r\n    @location(0) position : vec3<f32>,\r\n    @location(1) lifetime :f32\r\n};\r\n\r\nstruct VertexOutput {\r\n    @builtin(position) position : vec4<f32>,\r\n    @location(0) uv: vec2<f32>,\r\n    @location(1) lifetime: f32\r\n};\r\n\r\n@vertex\r\nfn main_instancing(vertexInput: VertexInput, @builtin(vertex_index) VertexIndex: u32) -> VertexOutput {\r\n    return mainVert(vertexInput.position, vertexInput.lifetime, VertexIndex);\r\n}\r\n\r\n\r\n@vertex\r\nfn main_vertex_pulling(@builtin(vertex_index) vertexIndex: u32) -> VertexOutput {\r\n    let particleIdx = u32(vertexIndex/6);\r\n    let quadIdx = vertexIndex % 6;\r\n    let particle = particleBuffer.particles[particleIdx];\r\n\r\n    return mainVert(particle.position, particle.lifetime, quadIdx);\r\n}\r\n\r\nfn mainVert(particlePos: vec3<f32>, particleLifetime: f32, quadVertIdx: u32) -> VertexOutput {\r\n            var halfwidth = uniforms.halfwidth;\r\n            var halfheight = uniforms.halfheight;\r\n\r\n            var quadPos = array<vec2<f32>, 6>(\r\n                vec2<f32>(-halfwidth, halfheight),   //tl\r\n                vec2<f32>(-halfwidth, -halfheight),  //bl\r\n                vec2<f32>(halfwidth, -halfheight),   //br\r\n\r\n                vec2<f32>(halfwidth, -halfheight),   //br\r\n                vec2<f32>(halfwidth, halfheight),    //tr\r\n                vec2<f32>(-halfwidth, halfheight)    //tl\r\n            );\r\n\r\n            var uvs = array<vec2<f32>, 6>(\r\n                vec2<f32>(0, 1),  //tl\r\n                vec2<f32>(0, 0),  //bl\r\n                vec2<f32>(1, 0),  //br\r\n\r\n                vec2<f32>(1, 0),   //br\r\n                vec2<f32>(1, 1),   //tr\r\n                vec2<f32>(0, 1)    //tl\r\n            );\r\n\r\n\r\n            var transformedPosition : vec4<f32> = camera.viewProjectionMatrix * vec4<f32>(particlePos, 1.0);\r\n\r\n            var output: VertexOutput;\r\n            output.position = vec4<f32>(transformedPosition.x + quadPos[quadVertIdx].x, transformedPosition.y + quadPos[quadVertIdx].y, transformedPosition.z, 1.0);\r\n            output.uv = uvs[quadVertIdx];\r\n            output.lifetime = particleLifetime;\r\n            return output;\r\n}\r\n"},912:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n="struct ParticleFragmentUniforms {\r\n   color: vec4<f32>,\r\n   color2: vec4<f32>,\r\n   maxLifetime: f32,\r\n   alphaFactor: f32\r\n}\r\n\r\n@binding(2) @group(0) var textureSampler : sampler;\r\n@binding(3) @group(0) var textureData : texture_2d<f32>;\r\n@binding(4) @group(0) var<uniform> particleUniforms: ParticleFragmentUniforms;\r\n\r\n@fragment\r\nfn main(@location(0) uv: vec2<f32>, @location(1) lifetime: f32) -> @location(0) vec4<f32> {\r\n    var textureColor : vec4<f32> = textureSample(textureData, textureSampler, uv);\r\n\r\n    //todo: not draw if lifetime <= 0\r\n\r\n    // interpolate between the two colors\r\n    var colorWeight = lifetime / particleUniforms.maxLifetime;\r\n    var maxLifetimeColor = textureColor * particleUniforms.color;\r\n    var minLifetimeColor = textureColor * particleUniforms.color2;\r\n    var fragColor = maxLifetimeColor * colorWeight + minLifetimeColor * (1.0-colorWeight);\r\n    fragColor.a = textureColor.a * particleUniforms.alphaFactor;\r\n    return fragColor;\r\n}\r\n\r\n\r\n"},269:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BenchmarkLogger=void 0;const i=r(158);e.BenchmarkLogger=class{constructor(t){this.duration=t,this.startTimestamp=performance.now(),this.text="frame_duration"}addEntry(t){return n(this,void 0,void 0,(function*(){if(console.log("adding entry"),0==this.duration)return;if(performance.now()-this.startTimestamp>1e3*this.duration)return this.createFile(),void(this.duration=0);const e=yield t.getAllBufferEntries(),r=e[i.TimeStamps.START_COMPUTE_IDX],n=e[i.TimeStamps.END_RENDER_IDX];this.text+="\n"+(r-n)}))}createFile(){console.log("creating file"),this.downloadFile("log.csv",this.text)}downloadFile(t,e){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},365:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FpsCounter=void 0,e.FpsCounter=class{constructor(){this._frameCounter=0,this._targetFPS=60,this._frameStartTime=performance.now()}update(){let t=performance.now();if(t-this._frameStartTime>1e3){const e=document.getElementById("fps-counter");if(!e)throw new Error("FPS counter html element not found");e.textContent=this._frameCounter+" FPS",this._frameCounter>=this._targetFPS?e.style.color="DarkGreen":this._frameCounter>=this._targetFPS-10?e.style.color="DarkGoldenRod":e.style.color="DarkRed",this._frameStartTime=t,this._frameCounter=0}this._frameCounter++}get frameCounter(){return this._frameCounter}get targetFPS(){return this._targetFPS}set targetFPS(t){this._targetFPS=t}}},517:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FragmentUniformBuffer=void 0,e.FragmentUniformBuffer=class{constructor(t,e,r,n,i){this._bufferSize=64,this.COLOR_OFFSET=0,this.COLOR2_OFFSET=this.COLOR_OFFSET+16,this.MAX_LIFETIME_OFFSET=this.COLOR2_OFFSET+16,this.ALPHA_FACTOR_OFFSET=this.MAX_LIFETIME_OFFSET+4,this._device=t,this._uniformBuffer=t.createBuffer({size:this._bufferSize,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setColor(e),this.setColor2(r),this.setMaxLifetime(n),this.setAlphaFactor(i)}setColor(t){this._device.queue.writeBuffer(this._uniformBuffer,this.COLOR_OFFSET,t)}setColor2(t){this._device.queue.writeBuffer(this._uniformBuffer,this.COLOR2_OFFSET,t)}setMaxLifetime(t){this._device.queue.writeBuffer(this._uniformBuffer,this.MAX_LIFETIME_OFFSET,Float32Array.of(t))}setAlphaFactor(t){this._device.queue.writeBuffer(this._uniformBuffer,this.ALPHA_FACTOR_OFFSET,Float32Array.of(t))}get device(){return this._device}get uniformBuffer(){return this._uniformBuffer}get bufferSize(){return this._bufferSize}}},906:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleGUI=void 0;const o=a(r(376)),s=r(913);e.ParticleGUI=class{constructor(){this.gui=new o.GUI,this._guiData={useCPU:!1,vertexPulling:!0,particleColor2:[252,118,39,255],particleColor:[230,220,155,255],numberOfParticles:1e6,minParticleLifetime:1,maxParticleLifetime:5,particleHeight:15,particleWidth:15,particleBrightness:.2},this.gui.remember(this._guiData),this.gui.add(this._guiData,"vertexPulling"),this.gui.add(this._guiData,"particleHeight"),this.gui.add(this._guiData,"particleWidth"),this.gui.add(this._guiData,"numberOfParticles"),this.gui.add(this._guiData,"minParticleLifetime"),this.gui.add(this._guiData,"maxParticleLifetime"),this.gui.add(this._guiData,"particleBrightness"),this.gui.addColor(this._guiData,"particleColor"),this.gui.addColor(this._guiData,"particleColor2")}get guiData(){return this._guiData.numberOfParticles*s.Particles.INSTANCE_SIZE>134217727&&(window.alert("Too many particles. Maximum number of particles: "+Math.floor(134217727/32)),this._guiData.numberOfParticles=Math.floor(134217727/32)),this._guiData}}},949:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CheckWebGPU=void 0,e.CheckWebGPU=()=>{let t="Great, your current browser supports WebGPU!";return navigator.gpu||(t='Your current browser does not support WebGPU! Make sure you are on a system \n                     with WebGPU enabled. Currently, SPIR-WebGPU is only supported in  \n                     <a href="https://www.google.com/chrome/canary/">Chrome canary</a>\n                     with the flag "enable-unsafe-webgpu" enabled. See the \n                     <a href="https://github.com/gpuweb/gpuweb/wiki/Implementation-Status"> \n                     Implementation Status</a> page for more details.                   \n                    '),t}},620:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OrbitCamera=void 0;const n=r(887);class i{constructor(t,e,r,a=60,o=16/9,s=.001,u=1e3){this._rotationQuat=n.quat.create(),this._viewMatrix=n.mat4.create(),this.ZOOM_FACTOR=.001,this.MAX_ZOOM=500,this.MIN_ZOOM=.01,this.MOVE_FACTOR=1,this._prevMouseX=0,this._prevMouseY=0,this.currentXRotation=0,this.onMouseMove=t=>{let e=t.clientX,r=t.clientY;if(1===t.buttons){let t=(e-this._prevMouseX)*this.MOVE_FACTOR,n=(r-this._prevMouseY)*this.MOVE_FACTOR;this.rotate(0,t,0),this.rotate(n,0,0)}this._prevMouseX=e,this._prevMouseY=r},this._position=t,this._target=e,this._up=r,this._projectionMatrix=i.perspectiveWebGpuFormat(n.glMatrix.toRadian(a),o,s,u),this.updateViewMatrix();const c=document.getElementById("canvas-webgpu");c.onwheel=t=>{this.onMouseWheel(t.deltaY)},c.addEventListener("mousemove",this.onMouseMove)}getViewProjectionMatrix(){this.updateViewMatrix();let t=n.mat4.create();return n.mat4.multiply(t,this._projectionMatrix,this._viewMatrix),t}onMouseWheel(t){this._position[2]+=t*this.ZOOM_FACTOR,this._position[2]=Math.min(this.MAX_ZOOM,this._position[2]),this._position[2]=Math.max(this.MIN_ZOOM,this._position[2])}updateViewMatrix(){const t=n.mat4.create(),e=n.mat4.create();n.mat4.lookAt(t,this._position,this._target,this._up),n.mat4.fromQuat(e,this._rotationQuat),this._viewMatrix=t,this._viewMatrix=n.mat4.multiply(this._viewMatrix,t,e)}rotate(t,e,r){this.currentXRotation+=t;let i=Math.max(-89,this.currentXRotation);i=Math.min(89,i),t+=i-this.currentXRotation,this.currentXRotation=i;let a=n.quat.create();a=n.quat.fromEuler(a,t,e,r),n.quat.multiply(this._rotationQuat,a,this._rotationQuat),this.updateViewMatrix()}static perspectiveWebGpuFormat(t,e,r,i){let a=n.mat4.create();const o=Math.tan(.5*Math.PI-.5*t),s=1/(r-i);return a[0]=o/e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=i*s,a[11]=-1,a[12]=0,a[13]=0,a[14]=r*i*s,a[15]=0,a}get position(){return this._position}set position(t){this._position=t,this.updateViewMatrix()}get target(){return this._target}set target(t){this._target=t,this.updateViewMatrix()}get up(){return this._up}set up(t){this._up=t,this.updateViewMatrix()}}e.OrbitCamera=i},913:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Particles=void 0;const i=r(887),a=r(593),o=n(r(275)),s=r(86);class u{constructor(t,e){this._numParticles=1e3,this._originPos=i.vec3.fromValues(0,0,0),this._initialVelocity=1.2,this._minParticleLifetime=2,this._maxParticleLifetime=5,this._gravity=[0,-1,0],this._maxNumParticlesSpawnPerSecond=80,this._simulationMaxIdx=0,this._firstFrameMaxIdx=0,this._particlePositionsCPU=new Float32Array,this._particleVelocitiesCPU=new Float32Array,this._particleLifetimesCPU=new Float32Array,this._device=t,this._useCPU=e,this._useCPU||this.initGPU()}initCPU(){console.log("setting up cpu particles"),this._particlePositionsCPU=new Float32Array(3*this._numParticles);for(let t=0;t<this._numParticles;t++)this._particlePositionsCPU.set(this._originPos,3*t);this.createCPUParticleBuffer(),this._particleVelocitiesCPU=new Float32Array(3*this._numParticles),this._particleLifetimesCPU=new Float32Array(this._numParticles);for(let t=0;t<this._numParticles;t++){let e=u.getRandomVec3(!0);i.vec3.scale(e,e,this._initialVelocity),this._particleVelocitiesCPU.set(e,3*t),this._particleLifetimesCPU.set([0],t)}new Float32Array(this._particleBuffer.getMappedRange()).set(this._particlePositionsCPU),this._particleBuffer.unmap()}createCPUParticleBuffer(t=!1){this._particleBuffer=this._device.createBuffer({size:this._numParticles*u.INSTANCE_SIZE,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.STORAGE,mappedAtCreation:!0}),t&&(new Float32Array(this._particleBuffer.getMappedRange()).set(this._particlePositionsCPU),this._particleBuffer.unmap())}createGPUParticleBuffer(){this._particleBuffer=this._device.createBuffer({size:this._numParticles*u.INSTANCE_SIZE,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST}),this._simulationStartTime=performance.now(),this._firstFrameMaxIdx=this._numParticles/(this._maxParticleLifetime-this._minParticleLifetime)*2.5+1,this._simulationMaxIdx=this._firstFrameMaxIdx}initGPU(){console.log("setting up gpu particles"),this.createGPUParticleBuffer(),this._simulationUniformBuffer=new s.SimulationUniformBuffer(this._device);const t={layout:"auto",compute:{module:this._device.createShaderModule({code:o.default}),entryPoint:"simulate"}};this._simulationPipeline=this._device.createComputePipeline(t),this.createSimulationBindGroup()}createSimulationBindGroup(){var t;if(!this._simulationPipeline||!this._simulationUniformBuffer)throw new Error("simulation pipeline or uniform buffer not defined");const e={layout:this._simulationPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._particleBuffer,offset:0,size:null===(t=this._particleBuffer)||void 0===t?void 0:t.size}},{binding:1,resource:{buffer:this._simulationUniformBuffer.uniformBuffer,offset:0,size:this._simulationUniformBuffer.bufferSize}}]};this._simulationBindGroup=this._device.createBindGroup(e)}update(t){this._useCPU?this.updateCPU(t):this.updateGPU(t)}updateGPU(t){var e,r,n,i,a,o,s,u,c,l,f;if(!this._simulationPipeline)throw new Error("Simulation pipeline not defined");if(!this._simulationBindGroup)throw new Error("Simulation bind group not defined");null===(e=this._simulationUniformBuffer)||void 0===e||e.setDeltaTime(t),null===(r=this._simulationUniformBuffer)||void 0===r||r.setMinLifetime(this._minParticleLifetime),null===(n=this._simulationUniformBuffer)||void 0===n||n.setMaxLifetime(this._maxParticleLifetime),null===(i=this._simulationUniformBuffer)||void 0===i||i.setGravity(this._gravity),null===(a=this._simulationUniformBuffer)||void 0===a||a.setOrigin(this._originPos),null===(o=this._simulationUniformBuffer)||void 0===o||o.setInitialVelocity(this._initialVelocity);const h=2*(Math.random()-.5);null===(s=this._simulationUniformBuffer)||void 0===s||s.setRandSeed(h),this._simulationStartTime&&performance.now()-this._simulationStartTime<1e3?(this._simulationMaxIdx+=.95*(this._numParticles-this._firstFrameMaxIdx)*t,null===(u=this._simulationUniformBuffer)||void 0===u||u.setMaxIdx(this._simulationMaxIdx)):null===(c=this._simulationUniformBuffer)||void 0===c||c.setMaxIdx(0);const d=this._device.createCommandEncoder();null===(l=this._timestamps)||void 0===l||l.writeTimestamp(d,0);const m=d.beginComputePass();m.setPipeline(this._simulationPipeline),m.setBindGroup(0,this._simulationBindGroup),m.dispatchWorkgroups(Math.ceil(this._numParticles/256)),m.end(),null===(f=this._timestamps)||void 0===f||f.writeTimestamp(d,1),this._device.queue.submit([d.finish()])}updateData(t){if(t.guiData.useCPU!=this._useCPU&&(this._useCPU=t.guiData.useCPU,this._useCPU?this.initCPU():this.initGPU()),this._minParticleLifetime=t.guiData.minParticleLifetime,this._maxParticleLifetime=t.guiData.maxParticleLifetime,this._useCPU)if(t.guiData.numberOfParticles>this._numParticles){let e=new Float32Array(3*t.guiData.numberOfParticles),r=new Float32Array(3*t.guiData.numberOfParticles),n=new Float32Array(t.guiData.numberOfParticles);e.set(this._particlePositionsCPU,0),r.set(this._particleVelocitiesCPU,0),n.set(this._particleLifetimesCPU,0),this._numParticles=t.guiData.numberOfParticles,this._particlePositionsCPU=e,this._particleVelocitiesCPU=r,this._particleLifetimesCPU=n,console.log("Particle limit increased to "+this._numParticles)}else t.guiData.numberOfParticles<this._numParticles&&(this._numParticles=t.guiData.numberOfParticles,this._particlePositionsCPU=this._particlePositionsCPU.slice(0,3*this._numParticles),this._particleVelocitiesCPU=this._particleVelocitiesCPU.slice(0,3*this._numParticles),this._particleLifetimesCPU=this._particleLifetimesCPU.slice(0,this._numParticles),console.log("Particle limit decreased to "+this._numParticles));else if(t.guiData.numberOfParticles!=this._numParticles){let e=this._particleBuffer;const r=this._numParticles;if(this._numParticles=t.guiData.numberOfParticles,this.createGPUParticleBuffer(),!e||!this._particleBuffer)throw new Error("Particle Buffer now defined");{const t=this._device.createCommandEncoder();t.copyBufferToBuffer(e,0,this._particleBuffer,0,Math.min(this._numParticles,r)),this._device.queue.submit([t.finish()])}null==e||e.destroy(),this.createSimulationBindGroup()}}updateCPU(t){var e;const r=Math.max(this._maxNumParticlesSpawnPerSecond*t,0==this._maxNumParticlesSpawnPerSecond?0:1);for(let e=0;e<this._numParticles;e++){let n=i.vec3.fromValues(this._particlePositionsCPU[3*e],this._particlePositionsCPU[3*e+1],this._particlePositionsCPU[3*e+2]),o=i.vec3.fromValues(this._particleVelocitiesCPU[3*e],this._particleVelocitiesCPU[3*e+1],this._particleVelocitiesCPU[3*e+2]),s=this._particleLifetimesCPU[e];if(s<=0){if(0>=r)continue;n=this._originPos,o=u.getRandomVec3(!0),i.vec3.scale(o,o,this._initialVelocity),s=this._minParticleLifetime+Math.random()*(this._maxParticleLifetime-this._minParticleLifetime),this._particlePositionsCPU.set(n,3*e),this._particleVelocitiesCPU.set(o,3*e),this._particleLifetimesCPU.set([s],e)}else o=i.vec3.add(o,o,(0,a.multiplyVec3WithNumber)(this.gravity,t)),i.vec3.add(n,n,(0,a.multiplyVec3WithNumber)(o,t)),s-=t,this._particlePositionsCPU.set(n,3*e),this._particleVelocitiesCPU.set(o,3*e),this._particleLifetimesCPU.set([s],e)}null===(e=this._particleBuffer)||void 0===e||e.destroy(),this.createCPUParticleBuffer(!0)}static getRandomVec3(t=!1){let e=i.vec3.create();return e[0]=2*(Math.random()-.5),e[1]=2*(Math.random()-.5),e[2]=2*(Math.random()-.5),t&&i.vec3.normalize(e,e),e}get numParticles(){return this._numParticles}get originPos(){return this._originPos}get particleBuffer(){return this._particleBuffer}get initialVelocity(){return this._initialVelocity}set initialVelocity(t){this._initialVelocity=t}get gravity(){return this._gravity}set gravity(t){this._gravity=t}get maxNumParticlesSpawnPerSecond(){return this._maxNumParticlesSpawnPerSecond}set maxNumParticlesSpawnPerSecond(t){this._maxNumParticlesSpawnPerSecond=t}set timestamps(t){this._timestamps=t}}e.Particles=u,u.INSTANCE_SIZE=32},419:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;const a=r(949),o=i(r(912)),s=i(r(147)),u=r(356),c=r(766),l=r(887),f=r(913),h=r(517),d=r(593),m=r(620),p=r(365),_=r(158),v=r(269);e.Renderer=class{constructor(){this.lastTime=0,this.deltaTime=0,this.useVertexPulling=!0,this.format="bgra8unorm",this.previousNumParticles=0,this.canvasWidth=0,this.canvasHeight=0,this.initCheck=()=>n(this,void 0,void 0,(function*(){const t=(0,a.CheckWebGPU)();if(t.includes("Your current browser does not support WebGPU!"))throw console.log(t),window.alert(t),"Your current browser does not support WebGPU!"})),this.initRenderer=(t=!1)=>n(this,void 0,void 0,(function*(){var t;const e=document.getElementById("canvas-webgpu");this.canvasWidth=e.width,this.canvasHeight=e.height;const r=yield null===(t=navigator.gpu)||void 0===t?void 0:t.requestAdapter();try{this.device=yield r.requestDevice({requiredFeatures:["timestamp-query"]}),this.timestamps=new _.TimeStamps(this.device)}catch(t){console.log("Timestamp queries not supported by this browser."),this.device=null}finally{this.device||(this.device=yield r.requestDevice())}this.context=e.getContext("webgpu"),this.format="bgra8unorm",this.context.configure({device:this.device,format:this.format,alphaMode:"opaque"}),this.benchmark=new v.BenchmarkLogger(5),yield this.initParticleRenderingPipeline()}))}calculateDeltaTime(){var t;if(!this.lastTime)return this.lastTime=performance.now(),this.deltaTime=0,void(this.fpsCounter=new p.FpsCounter);const e=performance.now();this.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e,null===(t=this.fpsCounter)||void 0===t||t.update()}initParticleRenderingPipeline(t=!1){return n(this,void 0,void 0,(function*(){if(this.particleRenderPipelineInstancing=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.device.createShaderModule({code:s.default}),entryPoint:"main_instancing",buffers:[{arrayStride:f.Particles.INSTANCE_SIZE,stepMode:"instance",attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32"}]}]},fragment:{module:this.device.createShaderModule({code:o.default}),entryPoint:"main",targets:[{format:this.format,blend:{color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"},alpha:{srcFactor:"zero",dstFactor:"one",operation:"add"}}}]},primitive:{topology:"triangle-list"}}),this.particleRenderPipelineVertexPulling=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.device.createShaderModule({code:s.default}),entryPoint:"main_vertex_pulling"},fragment:{module:this.device.createShaderModule({code:o.default}),entryPoint:"main",targets:[{format:this.format,blend:{color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"},alpha:{srcFactor:"zero",dstFactor:"one",operation:"add"}}}]},primitive:{topology:"triangle-list"}}),!this.particleRenderPipelineVertexPulling)throw new Error("Vertex Pulling Pipeline creation failed.");this.vertexUniformBuffer=new c.VertexUniformBuffer(this.device,this.canvasHeight,this.canvasWidth,10,10),this.fragmentUniformBuffer=new h.FragmentUniformBuffer(this.device,l.vec3.fromValues(0,1,0),l.vec3.fromValues(1,0,0),5,.2),this.camera=new m.OrbitCamera([0,0,-1],[0,0,0],[0,1,0],90,this.canvasWidth/this.canvasHeight),this.cameraUniformBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.writeCameraBuffer(),this.particleSystem=new f.Particles(this.device,t),this.timestamps&&(this.particleSystem.timestamps=this.timestamps);const e=yield(0,u.loadTexture)(this.device,"circle_05.png");this.uniformBindGroup=this.device.createBindGroup({layout:this.particleRenderPipelineInstancing.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.vertexUniformBuffer.uniformBuffer,offset:0,size:this.vertexUniformBuffer.bufferSize}},{binding:2,resource:e.sampler},{binding:3,resource:e.texture.createView()},{binding:1,resource:{buffer:this.cameraUniformBuffer,offset:0,size:64}},{binding:4,resource:{buffer:this.fragmentUniformBuffer.uniformBuffer,offset:0,size:this.fragmentUniformBuffer.bufferSize}}]}),this.uniformBindGroupVP=this.device.createBindGroup({layout:this.particleRenderPipelineVertexPulling.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.vertexUniformBuffer.uniformBuffer,offset:0,size:this.vertexUniformBuffer.bufferSize}},{binding:2,resource:e.sampler},{binding:3,resource:e.texture.createView()},{binding:1,resource:{buffer:this.cameraUniformBuffer,offset:0,size:64}},{binding:4,resource:{buffer:this.fragmentUniformBuffer.uniformBuffer,offset:0,size:this.fragmentUniformBuffer.bufferSize}}]}),this.createParticleBufferBindGroup()}))}createParticleBufferBindGroup(){var t;if(!this.particleRenderPipelineVertexPulling||!this.particleSystem)throw new Error("error creating particle buffer");this.particleBufferBindGroup=this.device.createBindGroup({layout:this.particleRenderPipelineVertexPulling.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:this.particleSystem.particleBuffer,offset:0,size:null===(t=this.particleSystem.particleBuffer)||void 0===t?void 0:t.size}}]})}renderParticles(){var t,e,r,n,i;null===(t=this.particleSystem)||void 0===t||t.update(this.deltaTime),this.writeCameraBuffer();const a=this.device.createCommandEncoder();this.timestamps&&this.timestamps.writeTimestamp(a,2);const o=this.context.getCurrentTexture().createView(),s=a.beginRenderPass({colorAttachments:[{view:o,clearValue:{r:.1,g:.17,b:.25,a:1},loadOp:"clear",storeOp:"store"}]});if(!this.particleSystem)throw new Error("particle system not setup");if(this.useVertexPulling?(s.setPipeline(this.particleRenderPipelineVertexPulling),s.setBindGroup(0,this.uniformBindGroupVP),this.previousNumParticles!=this.particleSystem.numParticles&&(this.createParticleBufferBindGroup(),this.previousNumParticles=this.particleSystem.numParticles),s.setBindGroup(1,this.particleBufferBindGroup),s.draw(6*(null===(r=this.particleSystem)||void 0===r?void 0:r.numParticles),1,0,0),s.end()):(s.setPipeline(this.particleRenderPipelineInstancing),s.setBindGroup(0,this.uniformBindGroup),s.setVertexBuffer(0,this.particleSystem.particleBuffer),s.draw(6,null===(e=this.particleSystem)||void 0===e?void 0:e.numParticles,0,0),s.end()),this.timestamps&&(null===(n=this.timestamps)||void 0===n||n.writeTimestamp(a,3),this.timestamps.resolveQuerySet(a)),this.device.queue.submit([a.finish()]),console.log(this.timestamps),this.timestamps){const t=this.timestamps.getBufferEntry(0),e=this.timestamps.getBufferEntry(3);Promise.all([t,e]).then((t=>{console.log("Frame time: "+(t[1]-t[0])/1e6+" ms")})),console.log(this.benchmark),null===(i=this.benchmark)||void 0===i||i.addEntry(this.timestamps)}}frame(){this.calculateDeltaTime(),this.renderParticles()}updateData(t){var e,r,n,i,a,o;if(null===(e=this.particleSystem)||void 0===e||e.updateData(t),!this.fragmentUniformBuffer)throw new Error("Fragment uniform Buffer not defined!");const s=t.guiData,u=(0,d.vec3ToColor)((0,d.vec3FromArray)(s.particleColor));null===(r=this.fragmentUniformBuffer)||void 0===r||r.setColor(l.vec3.fromValues(u[0],u[1],u[2]));const c=(0,d.vec3ToColor)((0,d.vec3FromArray)(s.particleColor2));null===(n=this.fragmentUniformBuffer)||void 0===n||n.setColor2(l.vec3.fromValues(c[0],c[1],c[2])),null===(i=this.fragmentUniformBuffer)||void 0===i||i.setAlphaFactor(s.particleBrightness),null===(a=this.vertexUniformBuffer)||void 0===a||a.setHeight(s.particleHeight),null===(o=this.vertexUniformBuffer)||void 0===o||o.setWidth(s.particleWidth),this.useVertexPulling=s.vertexPulling}writeCameraBuffer(){if(!this.camera)throw new Error("renderer.camera not defined!");const t=new Float32Array([...this.camera.getViewProjectionMatrix()]);this.device.queue.writeBuffer(this.cameraUniformBuffer,0,t.buffer)}}},86:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SimulationUniformBuffer=void 0,e.SimulationUniformBuffer=class{constructor(t){this._bufferSize=48,this.DELTATIME_OFFSET=0,this.GRAVITY_OFFSET=16,this.ORIGIN_OFFSET=32,this.MIN_LIFETIME_OFFSET=this.ORIGIN_OFFSET+12,this.MAX_LIFETIME_OFFSET=this.MIN_LIFETIME_OFFSET+4,this.INITIAL_VELOCITY_OFFSET=this.MAX_LIFETIME_OFFSET+4,this.RAND_SEED_OFFSET=this.INITIAL_VELOCITY_OFFSET+4,this.MAX_IDX_OFFSET=this.RAND_SEED_OFFSET+4,this._device=t,this._bufferSize+=16,this._uniformBuffer=t.createBuffer({size:this._bufferSize,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}get uniformBuffer(){return this._uniformBuffer}get bufferSize(){return this._bufferSize}setDeltaTime(t){this._device.queue.writeBuffer(this._uniformBuffer,this.DELTATIME_OFFSET,Float32Array.of(t))}setGravity(t){this._device.queue.writeBuffer(this._uniformBuffer,this.GRAVITY_OFFSET,Float32Array.from(t))}setOrigin(t){this._device.queue.writeBuffer(this._uniformBuffer,this.ORIGIN_OFFSET,Float32Array.from(t))}setMinLifetime(t){this._device.queue.writeBuffer(this._uniformBuffer,this.MIN_LIFETIME_OFFSET,Float32Array.of(t))}setMaxLifetime(t){this._device.queue.writeBuffer(this._uniformBuffer,this.MAX_LIFETIME_OFFSET,Float32Array.of(t))}setInitialVelocity(t){this._device.queue.writeBuffer(this._uniformBuffer,this.INITIAL_VELOCITY_OFFSET,Float32Array.of(t))}setRandSeed(t){this._device.queue.writeBuffer(this._uniformBuffer,this.RAND_SEED_OFFSET,Float32Array.of(t))}setMaxIdx(t){(t<0||t>Math.floor(134217727/32))&&(t=0),this._device.queue.writeBuffer(this._uniformBuffer,this.MAX_IDX_OFFSET,Uint32Array.of(t))}}},356:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.loadTexture=e.Texture=void 0;class n{constructor(t,e){this.texture=t,this.sampler=e}}e.Texture=n,e.loadTexture=(t,e)=>r(void 0,void 0,void 0,(function*(){const r=document.createElement("img");r.src="../assets/"+e,yield r.decode();const i=yield createImageBitmap(r),a=t.createTexture({size:[i.width,i.height,1],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});t.queue.copyExternalImageToTexture({source:i},{texture:a},[i.width,i.height]);const o=t.createSampler({minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"});return new n(a,o)}))},158:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TimeStamps=void 0;class n{constructor(t){this._capacity=4,this._device=t,this._querySet=t.createQuerySet({type:"timestamp",count:this._capacity}),this._queryBuffer=t.createBuffer({size:8*this._capacity,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST})}getWholeBuffer(){return r(this,void 0,void 0,(function*(){return yield n.readBuffer(this._device,this._queryBuffer)}))}getBufferEntry(t){return r(this,void 0,void 0,(function*(){const e=yield this.getWholeBuffer(),r=new BigInt64Array(e);return Number(r[t])}))}getAllBufferEntries(){return r(this,void 0,void 0,(function*(){let t=new Array(5);const e=yield this.getWholeBuffer(),r=new BigInt64Array(e);for(let e=0;e<5;e++)t[e]=Number(r[e]);return t}))}writeTimestamp(t,e=0){t.writeTimestamp(this.querySet,e)}resolveQuerySet(t){t.resolveQuerySet(this.querySet,0,this.capacity,this.queryBuffer,0)}get capacity(){return this._capacity}get querySet(){return this._querySet}get queryBuffer(){return this._queryBuffer}}e.TimeStamps=n,n.START_COMPUTE_IDX=0,n.END_COMPUTE_IDX=1,n.START_RENDER_IDX=2,n.END_RENDER_IDX=3,n.readBuffer=(t,e)=>r(void 0,void 0,void 0,(function*(){const r=e.size,n=t.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),i=t.createCommandEncoder();i.copyBufferToBuffer(e,0,n,0,r);const a=i.finish();return t.queue.submit([a]),yield n.mapAsync(GPUMapMode.READ),n.getMappedRange()}))},593:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.multiplyVec3WithNumber=e.vec3ToColor=e.vec3FromArray=void 0;const n=r(887);function i(t,e){return n.vec3.fromValues(t[0]*e,t[1]*e,t[2]*e)}e.vec3FromArray=function(t){return n.vec3.fromValues(t[0],t[1],t[2])},e.vec3ToColor=function(t){return i(t,1/255)},e.multiplyVec3WithNumber=i},766:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VertexUniformBuffer=void 0,e.VertexUniformBuffer=class{constructor(t,e,r,n=5,i=5){if(this._bufferSize=8,this.HALFWIDTH_OFFSET=0,this.HALFHEIGHT_OFFSET=this.HALFWIDTH_OFFSET+4,e<=0||r<=0)throw new Error("Invalid canvas dimensions");this._canvasHeight=e,this._canvasWidth=r,this._device=t,this._uniformBuffer=t.createBuffer({size:this._bufferSize,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setHeight(n),this.setWidth(i)}get uniformBuffer(){return this._uniformBuffer}get bufferSize(){return this._bufferSize}setHeight(t){let e=.5*t/this._canvasHeight;this._device.queue.writeBuffer(this._uniformBuffer,this.HALFHEIGHT_OFFSET,Float32Array.of(e))}setWidth(t){let e=.5*t/this._canvasWidth;this._device.queue.writeBuffer(this._uniformBuffer,this.HALFWIDTH_OFFSET,Float32Array.of(e))}get canvasHeight(){return this._canvasHeight}set canvasHeight(t){this._canvasHeight=t}get canvasWidth(){return this._canvasWidth}set canvasWidth(t){this._canvasWidth=t}}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var a=e[n]={id:n,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{r(579);const t=r(419);let e=new(r(906).ParticleGUI),n=new t.Renderer;function i(){n.updateData(e),n.frame(),requestAnimationFrame(i)}n.initCheck().then((()=>n.initRenderer(e.guiData.useCPU).then((()=>requestAnimationFrame(i)))))})()})();
//# sourceMappingURL=main.bundle.js.map